<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>isNineSun&#39;s Blog</title>
  
  
  <link href="http://yoursite.com/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2024-01-22T12:57:43.085Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>NineSun</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>惯性人体姿态解算——动捕上位机的实现 Part2</title>
    <link href="http://yoursite.com/2024/01/22/HPS-Part2/"/>
    <id>http://yoursite.com/2024/01/22/HPS-Part2/</id>
    <published>2024-01-22T09:58:04.000Z</published>
    <updated>2024-01-22T12:57:43.085Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-设计思路"><a href="#1-设计思路" class="headerlink" title="1.设计思路"></a>1.设计思路</h2><p>通信方面没有太多要说的，是做了一个UDP的服务器用来接收设备的广播数据，然后将固定格式的数据进行解析，得到各个肢体的三轴值数据。<br>人物模型采用的是通过Vroid生成的模型，骨骼使用mixamo进行绑定，并在Unity中做人形骨骼绑定。得益于我设备是每个关节（肢体）可以分别获取Roll、Pitch和Yaw角，因此我可以直接进行正向动力学，即将获取到的肢体的角度偏转值直接赋值给上位机中的人体模型。因此，控制人物模型的核心代码其实很短：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将三轴值转化为Quaternion</span></span><br><span class="line">armRotation = UnityEngine.Quaternion.Euler(roll, yaw, -pitch);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将旋转值应用在模型骨骼上</span></span><br><span class="line">body.rotation = armRotation;</span><br></pre></td></tr></table></figure><h2 id="2-模型初始状态问题"><a href="#2-模型初始状态问题" class="headerlink" title="2.模型初始状态问题"></a>2.模型初始状态问题</h2><p>与直观的欧拉角不同，即使传入的初始状态都是（0，0，0），在头部应用的时候还没有问题，但是应用在模型手臂会导致手臂初始状态朝上而不是T-Pose，因此需要给手臂加一个初始状态矫正的Offset：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将三轴值转化为Quaternion</span></span><br><span class="line">armRotation = UnityEngine.Quaternion.Euler(roll, yaw, -pitch);</span><br><span class="line"><span class="comment">//初始状态矫正</span></span><br><span class="line">armRotationOffset = UnityEngine.Quaternion.Euler(XRotationOffset, YRotationOffset, ZRotationOffset);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将旋转值应用在模型骨骼上</span></span><br><span class="line">body.rotation = armRotation * armRotationOffset;</span><br></pre></td></tr></table></figure><h3 id="引入矫正前"><a href="#引入矫正前" class="headerlink" title="引入矫正前"></a>引入矫正前</h3><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/NoAdjust.jpg">    </p><h3 id="引入矫正后"><a href="#引入矫正后" class="headerlink" title="引入矫正后"></a>引入矫正后</h3><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/Adjust.jpg">    </p><h2 id="3-最终效果"><a href="#3-最终效果" class="headerlink" title="3.最终效果"></a>3.最终效果</h2><p>最终效果可以点击链接查看视频–&gt; <a href="https://github.com/isNineSun/Human-Pose-Estimation---Motion-Capture-Device/assets/42261713/1a74626f-e1af-4e56-bceb-0fe2316b3c24">https://github.com/isNineSun/Human-Pose-Estimation---Motion-Capture-Device/assets/42261713/1a74626f-e1af-4e56-bceb-0fe2316b3c24</a>    </p><h2 id="4-最后"><a href="#4-最后" class="headerlink" title="4.最后"></a>4.最后</h2><p>还真是迟来的Part2了，生活中有不少的事情这个就一直搁置下来了，最后实现的效果也并不能说尽善尽美了，还有很多遗憾和不足，希望能在之后的项目中注意并避免，能够弥补这次的些许遗憾。<br>项目软硬件皆以开源，Part1文章中有所有的开源链接–&gt;<a href="https://isninesun.github.io/2023/04/15/HPS-Part1/">惯性人体姿态解算——动捕设备的实现 Part1</a>，本上位机实现也在GitHub上开源了–&gt;<a href="https://github.com/isNineSun/Motion-Capture-Host-Software.git">Motion-Capture-Host-Software</a></p>]]></content>
    
    
    <summary type="html">这是一个与之前惯性动捕硬件设计配套的上位机软件，采用Unity开发，通过传统的正向动力学的方式去进行人体的姿态还原。</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="Unity" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/Unity/"/>
    
    
    <category term="惯性动补" scheme="http://yoursite.com/tags/%E6%83%AF%E6%80%A7%E5%8A%A8%E8%A1%A5/"/>
    
    <category term="姿态解算" scheme="http://yoursite.com/tags/%E5%A7%BF%E6%80%81%E8%A7%A3%E7%AE%97/"/>
    
    <category term="Unity" scheme="http://yoursite.com/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>【学习记录】记录一个简单的WPF应用抽屉的实现</title>
    <link href="http://yoursite.com/2024/01/11/MyDrawerDemo/"/>
    <id>http://yoursite.com/2024/01/11/MyDrawerDemo/</id>
    <published>2024-01-11T13:21:04.000Z</published>
    <updated>2024-01-11T13:27:52.957Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-摘要"><a href="#1-摘要" class="headerlink" title="1.摘要"></a>1.摘要</h2><p>记录一个基于MaterialDesign开源控件库改造的抽屉页面Demo，去除了一些不必要的元素以供更好的使用    </p><hr><h2 id="2-源码"><a href="#2-源码" class="headerlink" title="2.源码"></a>2.源码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">materialDesign:DrawerHost</span></span></span><br><span class="line"><span class="tag">          <span class="attr">x:Name</span>=<span class="string">&quot;DrawerHost&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">Width</span>=<span class="string">&quot;480&quot;</span> <span class="attr">Height</span>=<span class="string">&quot;480&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">HorizontalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">materialDesign:DrawerHost.BottomDrawerContent</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Height</span>=<span class="string">&quot;450&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">HorizontalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Orientation</span>=<span class="string">&quot;Horizontal&quot;</span> <span class="attr">Background</span>=<span class="string">&quot;AliceBlue&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Margin</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">                                <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">                                <span class="attr">Foreground</span>=<span class="string">&quot;Black&quot;</span></span></span><br><span class="line"><span class="tag">                                <span class="attr">Text</span>=<span class="string">&quot;BOTTOM BRACKET&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Margin</span>=<span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Command</span>=<span class="string">&quot;&#123;x:Static materialDesign:DrawerHost.CloseDrawerCommand&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Content</span>=<span class="string">&quot;CLOSE ALL&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Style</span>=<span class="string">&quot;&#123;StaticResource MaterialDesignFlatButton&#125;&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Margin</span>=<span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Command</span>=<span class="string">&quot;&#123;x:Static materialDesign:DrawerHost.CloseDrawerCommand&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">CommandParameter</span>=<span class="string">&quot;&#123;x:Static Dock.Bottom&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Content</span>=<span class="string">&quot;CLOSE THIS&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Style</span>=<span class="string">&quot;&#123;StaticResource MaterialDesignFlatButton&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">materialDesign:DrawerHost.BottomDrawerContent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">HorizontalAlignment</span>=<span class="string">&quot;Center&quot;</span> <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">              <span class="attr">Command</span>=<span class="string">&quot;&#123;x:Static materialDesign:DrawerHost.OpenDrawerCommand&#125;&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">CommandParameter</span>=<span class="string">&quot;&#123;x:Static Dock.Bottom&#125;&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">Content</span>=<span class="string">&quot;&#123;materialDesign:PackIcon Kind=ArrowDown&#125;&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">materialDesign:DrawerHost</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="3-效果演示"><a href="#3-效果演示" class="headerlink" title="3.效果演示"></a>3.效果演示</h2><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/PixPin_2024-01-11_21-23-30.gif">    </p>]]></content>
    
    
    <summary type="html">记录一个基于MaterialDesign开源控件库改造的抽屉页面Demo，去除了一些不必要的元素以供更好的使用</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="WPF" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/WPF/"/>
    
    
    <category term="桌面应用开发" scheme="http://yoursite.com/tags/%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Material Design Xaml ToolKit开源控件库的导入</title>
    <link href="http://yoursite.com/2024/01/10/MaterialDesignXamlToolKitImport/"/>
    <id>http://yoursite.com/2024/01/10/MaterialDesignXamlToolKitImport/</id>
    <published>2024-01-10T14:00:00.000Z</published>
    <updated>2024-01-11T13:29:04.401Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-摘要"><a href="#1-摘要" class="headerlink" title="1.摘要"></a>1.摘要</h2><p>Material Design Xaml ToolKit是一个非常好用的开源WPF控件库，这里介绍一下导入方式，以防忘记。</p><h2 id="2-项目导入"><a href="#2-项目导入" class="headerlink" title="2.项目导入"></a>2.项目导入</h2><p>项目导入直接使用NuGet即可，右键解决方案资源管理器中的”引用”，选择”管理NuGet程序包”，在弹出的管理页面中选择“浏览”，然后搜索MaterialDesign关键字，找到项目后选择“安装即可”<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/image.jpg">    </p><h2 id="3-项目配置"><a href="#3-项目配置" class="headerlink" title="3.项目配置"></a>3.项目配置</h2><p>首先去到 App.xaml 导入和配置 Toolkit：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Application</span> <span class="attr">x:Class</span>=<span class="string">&quot;Example.App&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:materialDesign</span>=<span class="string">&quot;http://materialdesigninxaml.net/winfx/xaml/themes&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">StartupUri</span>=<span class="string">&quot;MainWindow.xaml&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Application.Resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ResourceDictionary.MergedDictionaries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">materialDesign:BundledTheme</span> <span class="attr">BaseTheme</span>=<span class="string">&quot;Light&quot;</span> <span class="attr">PrimaryColor</span>=<span class="string">&quot;DeepPurple&quot;</span> <span class="attr">SecondaryColor</span>=<span class="string">&quot;Lime&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ResourceDictionary</span> <span class="attr">Source</span>=<span class="string">&quot;pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml&quot;</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;/<span class="name">ResourceDictionary.MergedDictionaries</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Application.Resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Application</span>&gt;</span></span><br></pre></td></tr></table></figure><p>随后需要配置窗口，在窗体xaml文件（一般是MainWindow.xaml）中的Windows中添加属性：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span> [<span class="attr">...</span>]</span></span><br><span class="line"><span class="tag">        <span class="attr">TextElement.Foreground</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignBody&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Background</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignPaper&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        [<span class="attr">...</span>] &gt;</span></span><br></pre></td></tr></table></figure><p>当然，如果想要最终的风格更为统一(字体)，效果更好，最好换成以下的属性配置：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span> [<span class="attr">...</span>]</span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:materialDesign</span>=<span class="string">&quot;http://materialdesigninxaml.net/winfx/xaml/themes&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">TextElement.Foreground</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignBody&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Background</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignPaper&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">TextElement.FontWeight</span>=<span class="string">&quot;Medium&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">TextElement.FontSize</span>=<span class="string">&quot;14&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">FontFamily</span>=<span class="string">&quot;&#123;materialDesign:MaterialDesignFont&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        [<span class="attr">...</span>] &gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-使用"><a href="#4-使用" class="headerlink" title="4.使用"></a>4.使用</h2><p>可以在网址 –&gt; <a href="https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/releases">MaterialDesignInXAMLToolKit发布网址</a> 中获取MaterialDesignInXAMLToolKit Demo 软件，在软件中会展示各种控件的效果，可以选择喜欢的控件然后直接Copy其右下角源码放在代码中使用。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/PixPin_2024-01-10_21-55-39.gif">    </p>]]></content>
    
    
    <summary type="html">Material Design Xaml ToolKit是一个非常好用的开源WPF控件库，这里介绍一下导入方式，以防忘记。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="WPF" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/WPF/"/>
    
    
    <category term="桌面应用开发" scheme="http://yoursite.com/tags/%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>关于Docker启动容器时报端口占用错误的问题</title>
    <link href="http://yoursite.com/2023/11/18/Docker_Peots_Error/"/>
    <id>http://yoursite.com/2023/11/18/Docker_Peots_Error/</id>
    <published>2023-11-17T18:28:30.309Z</published>
    <updated>2023-11-17T18:37:30.096Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Docker错误表现"><a href="#Docker错误表现" class="headerlink" title="Docker错误表现"></a>Docker错误表现</h2><p>Docker Desktop在启动容器的时候无法正常启动，并且报错  <span style="color:red;">Error: (HTTP code 500) server error - Ports are not available:……</span>。    </p><hr><h2 id="问题出现的可能原因"><a href="#问题出现的可能原因" class="headerlink" title="问题出现的可能原因"></a>问题出现的可能原因</h2><p>该问题在我这边大多是因为关闭Docker Desktop或者关机时候没有先正常关闭容器导致的，再次打开容器就会报错，但是实际上Docker在Windows上的支持确实不太好，有时候即使操作按流程走，也可能会出各种各样的问题，这个问题就是其中之一。    </p><hr><h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><p>如报错信息所说，端口不可用，上面的报错信息没有完全截取，后面其实有详细说明（写记录的时候报错信息已经清掉了），总的来说的大意其实就是端口被占用。那解决方向就很清晰了，想办法找出占用端口的进程，kill即可，根据上面分析的出现可能原因，这个占用的进程大概率是之前没关掉的容器。    </p><hr><h2 id="问题的解决方案"><a href="#问题的解决方案" class="headerlink" title="问题的解决方案"></a>问题的解决方案</h2><p>思路是，找到占用端口的设备，并且Kill之，网上看了下，有好几种方法，虽然前几种在我这里没生效，但先记录下：    </p><h3 id="1-netstat-nlp-查看占用端口号的服务"><a href="#1-netstat-nlp-查看占用端口号的服务" class="headerlink" title="1. netstat -nlp 查看占用端口号的服务"></a>1. netstat -nlp 查看占用端口号的服务</h3><p>   打开CMD命令行工具，下发netstat指令，findstr后面跟想查看的端口。<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat –aon | <span class="built_in">findstr</span> <span class="number">8892</span></span><br></pre></td></tr></table></figure><br>   会出现使用对应端口号的进程：<br>   <img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/CMD.jpg">    </p><p>   找到想要关闭的进程ID，Kill之即可，如：<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">taskkill</span>/pid <span class="number">14872</span></span><br></pre></td></tr></table></figure><br>   但是这种方式在我这里没有生效，原因是<code>netstat –aon | findstr 8892</code>什么也没查到，但是Docker 依然显示占用，无法运行容器。    </p><h3 id="2-docker-指令查看启动的容器"><a href="#2-docker-指令查看启动的容器" class="headerlink" title="2. docker 指令查看启动的容器"></a>2. docker 指令查看启动的容器</h3><p>   既然端口占用进程查不到，那就换个思路，看看现在有什么容器在运行，把对应容器关了，然后跟第一步一样，KILL之！<br>   查看所有在运行的Docker：   </p>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>   CMD命令行中出现部署的Docker 容器：<br>   <img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/cmd_docker.jpg">    </p><p>   然后接下来有几个选项：<br>   (1) 可以直接Kill之：<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker kill 容器ID或容器名 :直接关闭容器</span><br></pre></td></tr></table></figure><br>   (2) 可以用更优雅的方式Stop：<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID或容器名</span><br></pre></td></tr></table></figure><br>   (3) 也可以重启docker容器：<br>   不管容器是否启动，直接重启容器<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart</span><br></pre></td></tr></table></figure><br>遗憾的是上面的方法在我这里都没有奏效，restart可以打开容器，但是docker的端口映射应该还是错的原因吗，我没法从外部访问docker应用，当然如果没有外部访问的需求，只需要功能在运行即可，那其实可以将就用一下，至于kill和stop，在我这下发之后则看不出什么变化，容器依然无法在Desktop中启动，端口报错信息还在。    </p><h3 id="3-重启Winnat服务"><a href="#3-重启Winnat服务" class="headerlink" title="3. 重启Winnat服务"></a>3. 重启Winnat服务</h3><p>   这招对我来说百试百灵，既然端口被不知道什么东西占用那就一不做二不休，重启网络服务，重新分配端口，毕竟重启解决90%问题……<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> stop winnat</span><br></pre></td></tr></table></figure><br>   关闭winnat服务之后，再将其重新启动：<br>   <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> winnat</span><br></pre></td></tr></table></figure><br>   用这种方式，大部分情况下，都能解决我的端口占用问题。</p><hr><h2 id="问题的根本原因"><a href="#问题的根本原因" class="headerlink" title="问题的根本原因"></a>问题的根本原因</h2><p>在踩坑后网上找资料时候，看到人写过另一篇关于<a href="https://zhuanlan.zhihu.com/p/474392069">Windows 10 端口被 Hyper-V 随机保留（占用）的问题</a>帖子，我本人没系统学习过Web开发，所以大佬的分析确实让我有些茅塞顿开的感觉，之前虽然瞎猫碰上死耗子解决了问题，但是实际上还是不知道为什么会导致问题，甚至连到底是谁占用了端口都不知道……。因此记录一下：    </p><p><span style="color:red;">错误的解决方法:</span>    </p><blockquote><p>运行net stop winnat停止 winnat 服务，然后再运行net start winnat启动 winnat 服务。<br>这个方法本质上就是重启电脑的简化版……让Hyper-V再随机初始化一些端口保留，如果正好没随机到要用的端口，那一次成功。如果还是随机到了要用的端口，那就只能多来几次。<br>在那个问题的回答下，我看到有一些网友说「对我有用」，也有一些网友说「对我没用」，原因就是这个方法解决问题的概率完全是随机的……    </p></blockquote><p><span style="color:green;">正确的解决方法:</span>    </p><blockquote><p>正确的解决方法很简单，就是重新设置一下「TCP 动态端口范围」，让Hyper-V只在我们设定的范围内保留端口即可。可以以管理员权限运行下面的命令，将「TCP 动态端口范围」重新设定为49152-65535。如果你觉得这个范围太大，还可以改小一点。    </p></blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netsh int ipv4 <span class="built_in">set</span> dynamic tcp <span class="built_in">start</span>=<span class="number">49152</span> end=<span class="number">16384</span></span><br><span class="line">netsh int ipv6 <span class="built_in">set</span> dynamic tcp <span class="built_in">start</span>=<span class="number">49152</span> end=<span class="number">16384</span></span><br></pre></td></tr></table></figure><blockquote><p>然后重启电脑即可。<br>重启电脑后，再运行命令<code>netsh int ipv4 show dynamicport tcp</code>查看动态端口范围，发现确实已经修改为了49152-65535。现在只有这个范围内的端口可能会被保留了，基本不会影响日常使用。    </p></blockquote><p><strong>PS：</strong><br>还可以设置排除特定的端口，但是我自己没有尝试这种方法：    </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh int ipv4 add excludedportrange protocol=tcp startport=要排除的端口 numberofports=范围</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Docker错误表现&quot;&gt;&lt;a href=&quot;#Docker错误表现&quot; class=&quot;headerlink&quot; title=&quot;Docker错误表现&quot;&gt;&lt;/a&gt;Docker错误表现&lt;/h2&gt;&lt;p&gt;Docker Desktop在启动容器的时候无法正常启动，并且报错  &lt;sp</summary>
      
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="一些踩坑" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E4%B8%80%E4%BA%9B%E8%B8%A9%E5%9D%91/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="学习记录" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
    <category term="踩坑" scheme="http://yoursite.com/tags/%E8%B8%A9%E5%9D%91/"/>
    
    <category term="网络" scheme="http://yoursite.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
    <category term="端口" scheme="http://yoursite.com/tags/%E7%AB%AF%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>惯性人体姿态解算——动捕设备的实现 Part1</title>
    <link href="http://yoursite.com/2023/04/15/HPS-Part1/"/>
    <id>http://yoursite.com/2023/04/15/HPS-Part1/</id>
    <published>2023-04-15T09:58:04.000Z</published>
    <updated>2024-01-22T13:02:36.507Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-设计思路-amp-硬件选择"><a href="#1-设计思路-amp-硬件选择" class="headerlink" title="1.设计思路&amp;硬件选择"></a>1.设计思路&amp;硬件选择</h2><p>我希望动捕设备最好能无线连接PC，所以esp32就成了首选，不用再多加一个透传模块，而且价格也便宜，另外就是IMU的选型，这个的选择项就非常多了，一些精度高的IMU价格非常夸张，所以这里就使用最常见的六轴IMU MPU6050，物美价廉，漂移和噪声问题确定很大，但是可以放在软件算法里去尽量做优化，不过调过姿态控制的都知道，六轴传感器的偏航角几乎是不可用的，这是六轴传感器工作机制导致的，只能用角速度去积分获取偏航角，然后一定程度上通过横滚角和俯仰角去矫正，理想的状态下，静态响应还是凑合的，但是动态响应几乎就是灾难，在动捕这个领域，这显然是不合适的，因此为了获得更为准确的yaw角度，我选择添加一个磁力计，HMC5883L，虽然磁力计也同样会有被环境干扰问题，比如周围的磁场，但是它的yaw角很大程度上至少是可信的，环境干扰也可以放在软件算法里面去尽量矫正。<br>所以最后确定的下位机方案就是使用esp32+mpu6050+HMC5883L,成本大概30块钱左右，然后关于上位机的选择，因为这次涉及到3D模型，当然是请出老朋友unity，下位机采集解算出来的欧拉角直接通过wifi与PC走UDP（延时小）通信传输数据，然后再在PC端根据欧拉角还原人体姿态，大致思路就是这个样子。       </p><h2 id="2-硬件设计"><a href="#2-硬件设计" class="headerlink" title="2.硬件设计"></a>2.硬件设计</h2><p>硬件方面IMU直接用的是模块，因为裸片买不起（悲），然后尺寸尽可能小巧，没有画成两面板是因为就算把尺寸再画小一点，电池容量也可能不太够了，索性定在了45mm * 45mm的尺寸上了能一面画完，能放一个800mah的锂电池，项目工程都再立创开源了，以下是链接：<br><a href="https://oshwhub.com/isninesun/hpsv204">立创开源广场项目链接</a></p><h3 id="PCB-Layout-amp-3D渲染图片"><a href="#PCB-Layout-amp-3D渲染图片" class="headerlink" title="PCB Layout &amp; 3D渲染图片"></a>PCB Layout &amp; 3D渲染图片</h3><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/PCB.jpg">    </p><h3 id="实物图"><a href="#实物图" class="headerlink" title="实物图"></a>实物图</h3><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/8AC78D640ADDDDC2A6DC100C6488A9C2.jpg">    </p><h2 id="3-软件设计"><a href="#3-软件设计" class="headerlink" title="3.软件设计"></a>3.软件设计</h2><h3 id="3-1-设备软件"><a href="#3-1-设备软件" class="headerlink" title="3.1 设备软件"></a>3.1 设备软件</h3><p>软件上项目源代码我会放在github仓库上，需要参考的可直接点击–&gt;    </p><p>下面主要贴一些比较关键的代码:   </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Solution_algorithm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;init.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*计算偏移量*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> i;                                    <span class="comment">//计算偏移量时的循环次数</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> ax_offset = <span class="number">0</span>, ay_offset = <span class="number">0</span>;         <span class="comment">//x,y轴的加速度偏移量</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> gx_offset = <span class="number">0</span>, gy_offset = <span class="number">0</span>;         <span class="comment">//x,y轴的角速度偏移量</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> yaw_offset = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> mag_offset_x = <span class="number">0.0</span>, mag_offset_y = <span class="number">0.0</span>, mag_offset_z = <span class="number">0.0</span>; <span class="comment">//x,y,z轴的地磁偏移量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*参数*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> rad2deg = <span class="number">57.29578</span>;                   <span class="comment">//弧度到角度的换算系数</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> roll_v = <span class="number">0</span>, pitch_v = <span class="number">0</span>, yaw_v = <span class="number">0</span>;              <span class="comment">//换算到x,y,z轴上的角速度</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> gravity = <span class="number">9.8</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> alpha = <span class="number">0.5</span>;  <span class="comment">// 互补滤波系数</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> beta = <span class="number">0.1</span>;   <span class="comment">// 倾斜补偿系数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*定义微分时间*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> now = <span class="number">0</span>, lasttime = <span class="number">0</span>, dt = <span class="number">0</span>;        <span class="comment">//定义微分时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*三个状态，先验状态，观测状态，最优估计状态*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> gyro_roll = <span class="number">0</span>, gyro_pitch = <span class="number">0</span>, gyro_yaw = <span class="number">0</span>;        <span class="comment">//陀螺仪积分计算出的角度，先验状态</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> acc_roll = <span class="number">0</span>, acc_pitch = <span class="number">0</span>, acc_yaw = <span class="number">0</span>;          <span class="comment">//加速度计观测出的角度，观测状态</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> k_roll = <span class="number">0</span>, k_pitch = <span class="number">0</span>, t_yaw = <span class="number">0</span>;              <span class="comment">//卡尔曼滤波后估计出最优角度，最优估计状态</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> tilt_yaw = <span class="number">0</span>;  <span class="comment">//倾斜补偿后的yaw角数据</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> yaw_buf[WINDOW_SIZE];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*误差协方差矩阵P*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> e_P[<span class="number">2</span>][<span class="number">2</span>] =&#123;&#123;<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">1</span>&#125;&#125;;             <span class="comment">//误差协方差矩阵，这里的e_P既是先验估计的P，也是最后更新的P</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*卡尔曼增益K*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> k_k[<span class="number">2</span>][<span class="number">2</span>] =&#123;&#123;<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>&#125;&#125;;             <span class="comment">//这里的卡尔曼增益矩阵K是一个2X2的方阵</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">float</span> <span class="title">sliding_window_filter</span><span class="params">(<span class="keyword">float</span> *buf, <span class="keyword">float</span> new_data)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">float</span> sum = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = (WINDOW_SIZE - <span class="number">1</span>); i&gt;<span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        buf[i - <span class="number">1</span>] = buf[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将新数据存入缓存区</span></span><br><span class="line">    buf[WINDOW_SIZE - <span class="number">1</span>] = new_data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算缓存区中所有数据的和</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; WINDOW_SIZE; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += buf[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回平均值</span></span><br><span class="line">    <span class="keyword">return</span> sum / WINDOW_SIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Caculate_RollPitch_by_Kalman</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*计算微分时间*/</span></span><br><span class="line">    now = <span class="built_in">millis</span>();                           <span class="comment">//当前时间(ms)</span></span><br><span class="line">    dt = (now - lasttime) / <span class="number">1000.0</span>;           <span class="comment">//微分时间(s)</span></span><br><span class="line">    lasttime = now;                           <span class="comment">//上一次采样时间(ms)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*获取角速度和加速度 */</span></span><br><span class="line">    <span class="keyword">sensors_event_t</span> a, g, temp;</span><br><span class="line">    mpu.<span class="built_in">getEvent</span>(&amp;a, &amp;g, &amp;temp);<span class="comment">//获取加速度、角速度、温度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*step1:计算先验状态*/</span></span><br><span class="line">    <span class="comment">/*计算x,y轴上的角速度*/</span></span><br><span class="line">    roll_v = (g.gyro.x-gx_offset) + ((<span class="built_in">sin</span>(k_pitch)*<span class="built_in">sin</span>(k_roll))/<span class="built_in">cos</span>(k_pitch))*(g.gyro.y-gy_offset) + ((<span class="built_in">sin</span>(k_pitch)*<span class="built_in">cos</span>(k_roll))/<span class="built_in">cos</span>(k_pitch))*g.gyro.z;<span class="comment">//roll轴的角速度</span></span><br><span class="line">    pitch_v = <span class="built_in">cos</span>(k_roll)*(g.gyro.y-gy_offset) - <span class="built_in">sin</span>(k_roll)*g.gyro.z;<span class="comment">//pitch轴的角速度</span></span><br><span class="line">    gyro_roll = k_roll + dt*roll_v;<span class="comment">//先验roll角度</span></span><br><span class="line">    gyro_pitch = k_pitch + dt*pitch_v;<span class="comment">//先验pitch角度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*step2:计算先验误差协方差矩阵P*/</span></span><br><span class="line">    e_P[<span class="number">0</span>][<span class="number">0</span>] = e_P[<span class="number">0</span>][<span class="number">0</span>] + <span class="number">0.0025</span>;<span class="comment">//这里的Q矩阵是一个对角阵且对角元均为0.0025</span></span><br><span class="line">    e_P[<span class="number">0</span>][<span class="number">1</span>] = e_P[<span class="number">0</span>][<span class="number">1</span>] + <span class="number">0</span>;</span><br><span class="line">    e_P[<span class="number">1</span>][<span class="number">0</span>] = e_P[<span class="number">1</span>][<span class="number">0</span>] + <span class="number">0</span>;</span><br><span class="line">    e_P[<span class="number">1</span>][<span class="number">1</span>] = e_P[<span class="number">1</span>][<span class="number">1</span>] + <span class="number">0.0025</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*step3:更新卡尔曼增益K*/</span></span><br><span class="line">    k_k[<span class="number">0</span>][<span class="number">0</span>] = e_P[<span class="number">0</span>][<span class="number">0</span>]/(e_P[<span class="number">0</span>][<span class="number">0</span>]+<span class="number">0.3</span>);</span><br><span class="line">    k_k[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    k_k[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    k_k[<span class="number">1</span>][<span class="number">1</span>] = e_P[<span class="number">1</span>][<span class="number">1</span>]/(e_P[<span class="number">1</span>][<span class="number">1</span>]+<span class="number">0.3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*step4:计算最优估计状态*/</span></span><br><span class="line">    <span class="comment">/*观测状态*/</span></span><br><span class="line">    <span class="comment">//roll角度</span></span><br><span class="line">    acc_roll = <span class="built_in">atan</span>((a.acceleration.y - ay_offset) / (a.acceleration.z)) * rad2deg;</span><br><span class="line">    <span class="comment">//pitch角度</span></span><br><span class="line">    acc_pitch = <span class="number">-1</span>*<span class="built_in">atan</span>((a.acceleration.x - ax_offset) / <span class="built_in">sqrt</span>(<span class="built_in">sq</span>(a.acceleration.y - ay_offset) + <span class="built_in">sq</span>(a.acceleration.z))) * rad2deg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*最优估计状态*/</span></span><br><span class="line">    k_roll = gyro_roll + k_k[<span class="number">0</span>][<span class="number">0</span>]*(acc_roll - gyro_roll);</span><br><span class="line">    k_pitch = gyro_pitch + k_k[<span class="number">1</span>][<span class="number">1</span>]*(acc_pitch - gyro_pitch);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*step5:更新协方差矩阵P*/</span></span><br><span class="line">    e_P[<span class="number">0</span>][<span class="number">0</span>] = (<span class="number">1</span> - k_k[<span class="number">0</span>][<span class="number">0</span>])*e_P[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    e_P[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    e_P[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    e_P[<span class="number">1</span>][<span class="number">1</span>] = (<span class="number">1</span> - k_k[<span class="number">1</span>][<span class="number">1</span>])*e_P[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">caculate_Yaw</span><span class="params">(<span class="keyword">float</span> roll,<span class="keyword">float</span> pitch,<span class="keyword">bool</span> init_flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> rollRad = <span class="number">0</span>, pitchRad = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">float</span> xh = <span class="number">0</span>,yh = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">sensors_event_t</span> event; </span><br><span class="line">    mag.<span class="built_in">getEvent</span>(&amp;event);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(init_flag)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/*获取角速度和加速度 */</span></span><br><span class="line">        <span class="keyword">sensors_event_t</span> a, g, temp;</span><br><span class="line">        mpu.<span class="built_in">getEvent</span>(&amp;a, &amp;g, &amp;temp);</span><br><span class="line"></span><br><span class="line">        rollRad = <span class="built_in">asin</span>(-(a.acceleration.x/gravity));</span><br><span class="line">        pitchRad = <span class="built_in">atan</span>(a.acceleration.y/a.acceleration.z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        rollRad = roll/rad2deg;</span><br><span class="line">        pitchRad = pitch/rad2deg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xh = event.magnetic.x * <span class="built_in">cos</span>(pitchRad) + event.magnetic.y * <span class="built_in">sin</span>(pitchRad) * <span class="built_in">sin</span>(rollRad) + event.magnetic.z * <span class="built_in">sin</span>(pitchRad) * <span class="built_in">cos</span>(rollRad);</span><br><span class="line">    yh = event.magnetic.y * <span class="built_in">cos</span>(rollRad) - event.magnetic.z * <span class="built_in">sin</span>(rollRad);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate tilt compensated heading</span></span><br><span class="line">    <span class="keyword">float</span> tiltCompensatedHeading = <span class="built_in">atan2</span>(yh, xh);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Correct for when signs are reversed.</span></span><br><span class="line">    <span class="keyword">if</span>(tiltCompensatedHeading &lt; <span class="number">0</span>)</span><br><span class="line">        tiltCompensatedHeading += <span class="number">2</span>*PI;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// Check for wrap due to addition of declination.</span></span><br><span class="line">    <span class="keyword">if</span>(tiltCompensatedHeading &gt; <span class="number">2</span>*PI)</span><br><span class="line">        tiltCompensatedHeading -= <span class="number">2</span>*PI;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Convert radians to degrees for readability.</span></span><br><span class="line">    <span class="keyword">float</span> headingDegrees = tiltCompensatedHeading * <span class="number">180</span>/M_PI;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> headingDegrees;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">offset_init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">2000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">sensors_event_t</span> a, g, m, temp;</span><br><span class="line">        <span class="keyword">sensors_event_t</span> event; </span><br><span class="line">        mpu.<span class="built_in">getEvent</span>(&amp;a, &amp;g, &amp;temp);<span class="comment">//获取加速度、角速度、温度</span></span><br><span class="line">        mag.<span class="built_in">getEvent</span>(&amp;m);</span><br><span class="line">        ax_offset = ax_offset + a.acceleration.x;</span><br><span class="line">        ay_offset = ay_offset + a.acceleration.y;</span><br><span class="line">        gx_offset = gx_offset + g.gyro.x;</span><br><span class="line">        gy_offset = gy_offset + g.gyro.y;</span><br><span class="line"></span><br><span class="line">        mag_offset_x += m.magnetic.x;</span><br><span class="line">        mag_offset_y += m.magnetic.y;</span><br><span class="line">        mag_offset_z += m.magnetic.z;</span><br><span class="line">    &#125;</span><br><span class="line">    ax_offset = ax_offset / <span class="number">2000</span>;</span><br><span class="line">    ay_offset = ay_offset / <span class="number">2000</span>;</span><br><span class="line">    gx_offset = gx_offset / <span class="number">2000</span>;</span><br><span class="line">    gy_offset = gy_offset / <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line">    mag_offset_x /= <span class="number">2000</span>;</span><br><span class="line">    mag_offset_y /= <span class="number">2000</span>;</span><br><span class="line">    mag_offset_z /= <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        yaw_offset += <span class="built_in">caculate_Yaw</span>(k_roll, k_pitch, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    yaw_offset /= <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_Euler_angle</span><span class="params">(<span class="keyword">float</span>* roll, <span class="keyword">float</span>* pitch, <span class="keyword">float</span>* yaw)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Caculate_RollPitch_by_Kalman</span>();</span><br><span class="line">    tilt_yaw = <span class="built_in">caculate_Yaw</span>(k_roll, k_pitch, <span class="literal">false</span>);</span><br><span class="line">    tilt_yaw = tilt_yaw &gt;= yaw_offset ? (tilt_yaw - yaw_offset) : ((<span class="number">360.0</span> - yaw_offset) + tilt_yaw);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(tilt_yaw &gt; <span class="number">180.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        tilt_yaw -= <span class="number">360.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    t_yaw = <span class="built_in">sliding_window_filter</span>(yaw_buf, tilt_yaw);</span><br><span class="line"></span><br><span class="line">    *roll = k_roll;</span><br><span class="line">    *pitch = k_pitch;</span><br><span class="line">    *yaw = t_yaw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于IMU和磁力计采集到的数据都是有很大噪声的，而且消费级的IMU的漂移问题很严重，所以他们的数据直接拿来其实是不能用的，上面那段代码其实是一个卡尔曼滤波的处理，也算是姿态解算中很经典的处理算法了，具体的原理就不在这里展开了，关于卡尔曼滤波的教程和讲解网上有太多太多，我就不在这里班门弄斧了，卡尔曼滤波主要针对IMU，可以得到一个可用的Roll角和Pitch角，而Yaw角则需要用磁力计来解决，磁力计在外部坏境相对稳定的情况下，指北的表现还是比较好的，所以只对其数据进行简单的均值滤波其实在平面上就已可用，其问题在于倾斜情况下需要对磁偏角进行倾斜校正，不然会得到一个完全错误的数值，原因跟磁力计的工作方式有关，在此不多赘述，感兴趣可以看这篇文章了解其原理<a href="https://zhuanlan.zhihu.com/p/61765669%E3%80%82">基于加速度计与磁力计的姿态解算方法(加计补偿偏航)</a>。最后将获得的Roll、Pitch、Yaw角传出，后面的工作就是组报文 + UDP通信了，将数据传给PC上位机后，再由PC去根据欧拉角还原物体姿态。    </p><h3 id="3-2-上位机软件"><a href="#3-2-上位机软件" class="headerlink" title="3.2 上位机软件"></a>3.2 上位机软件</h3><p>如上面所说，上位机我用的是Unity，这里其实没有太多可说的，上位机全部的工作就是建立一个UDP的服务器，接收来自设备的包含欧拉角信息的消息并对其进行解析，然后使用角度信息对场景物体进行对应旋转，真要说的话，本文只是Part1，所以只做了一个Cube去做测试，具体人体姿态的解算和还原会放在Part2中去详细说明。上位机的Unity工程我同样会放在上文（3.1）提到的Github链接中。（Part2已更新–&gt;<a href="https://isninesun.github.io/2024/01/22/HPS-Part2/">惯性人体姿态解算——动捕上位机的实现 Part2</a>）    </p><h2 id="4-效果演示"><a href="#4-效果演示" class="headerlink" title="4.效果演示"></a>4.效果演示</h2><p>这里放一张动图用来展示实际的效果：<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/test%2000_00_00-00_00_30.gif"></p><h2 id="5-总结"><a href="#5-总结" class="headerlink" title="5.总结"></a>5.总结</h2><p>这篇主要是实现一个基础验证，显示完成数据采集的工作，具体根据采集的数据解算出来的欧拉角去还原姿态的部分我打算放在上位机去做，这个就要等到Part2再说了。</p>]]></content>
    
    
    <summary type="html">最近比较沉迷虚拟主播，用来打发时间还是挺有意思的，一些3D势虚拟主播不可避免的就是会使用到动作捕捉设备，产生了一些兴趣，想简单实现一下。现在市面上大多数的动补方案是光学动补、惯性动补和混合动补三种方式，光学动补精度高，但是成本也高，而且捕捉质量与摄像头帧率和数量直接相关，惯性动补成本相对比较低，但是会不可避免的有各种漂移问题，成品商业方案大多是最后一种，是光学和惯性结合起来去做拟合，从而达成比较好的稳定性和精度。光学动补现在已经有很多商业公司开放付费使用的服务了，比如小K动补之类的，所以本文就不介绍光捕，而实现一个惯性动补。</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="嵌入式" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="嵌入式开发" scheme="http://yoursite.com/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="ESP32" scheme="http://yoursite.com/tags/ESP32/"/>
    
    <category term="惯性动补" scheme="http://yoursite.com/tags/%E6%83%AF%E6%80%A7%E5%8A%A8%E8%A1%A5/"/>
    
    <category term="姿态解算" scheme="http://yoursite.com/tags/%E5%A7%BF%E6%80%81%E8%A7%A3%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>关于Vroid模型导入Unity的二三事</title>
    <link href="http://yoursite.com/2022/11/05/Model_Vroid2Unity/"/>
    <id>http://yoursite.com/2022/11/05/Model_Vroid2Unity/</id>
    <published>2022-11-05T12:06:04.000Z</published>
    <updated>2023-11-17T13:37:45.917Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-摘要"><a href="#1-摘要" class="headerlink" title="1.摘要"></a>1.摘要</h2><p>Unity开发避免不了3D模型的需求，个人美术能力有限，从blender撸一些小件还好，从零开始做人物模型暂时还是有点难为我了，所以只能先寻求他法，Vroid就是一个很好用的人物模型生成工具，这个软件可以一定程度降低对美术硬实力的要求，上手门槛低出模型效果却不错，但是Vroid导出的VRM文件如何很好地导入unity是个问题，中间也有不少坑，因此记录一下。    </p><hr><h2 id="2-准备环境"><a href="#2-准备环境" class="headerlink" title="2.准备环境"></a>2.准备环境</h2><ul><li>blender 3.5(使用到的插件支持到3.5，更高的版本可能会导致异常)</li><li>blender插件：(以下插件均已上传Onedrive)<ul><li>cats-blender-plugin</li><li>material-combiner</li><li>VRM_Addon_for_Blender</li></ul></li><li>Unity (版本不做限制)</li><li>Unity插件：VRM-0.115.0_7e05(一个shader，用来还原Vroid中的模型渲染效果)    </li></ul><hr><h2 id="3-Vroid模型准备"><a href="#3-Vroid模型准备" class="headerlink" title="3.Vroid模型准备"></a>3.Vroid模型准备</h2><p>首先，制作好合心意的Vroid模型，本博客就直接使用默认模板的那个角色了，点击右上角的导出按钮，选择<strong>Export as VRM</strong>。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/X5L%250UXRZ6JC%602J%405ZM6GZB.png"><br>进入导出页面，可以调整红框中的参数到合心意的效果，然后点击右下角的导出，导出.VRM模型。    </p><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/model.jpg">    </p><hr><h2 id="4-Blender转换"><a href="#4-Blender转换" class="headerlink" title="4.Blender转换"></a>4.Blender转换</h2><p>接下来是导入流程的重头戏，首先是需要给blender安装插件，然后按‘N’键打开侧边菜单，找到CATS插件栏。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/blender_20231105_1.jpg"><br>选择最上面的<code>Import Model</code>,然后选择刚在上一步从Vroid中导出的.vrm模型。<br>等待片刻模型加载完毕后，先什么都不要动，点击FixModel。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/chara.jpg"><br>稍等片刻后，模型修复完毕，接下来就是模型材质的提取，这一步完成之后在Unity可以直接引用材质贴图，配合对应的Shader实现还原Vroid中渲染的效果。<br>选择 <strong>Optimization</strong> 选项卡下的 <strong>Generate Material List</strong>。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/%5D8A%5BLSQ5MYB6N%7BA6YFEXPMK.png">    </p><p>此时顺利的话会正常生成模型对应的材质，这里有遇到一个坑，如果没有生成对应材质球，或者材质（贴图）为空，可能是插件没加载成功，重启Blender并重新<strong>Generate Material List</strong>。成功生成效果如下图：<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/71CJ%40MXBM_GD%25RTY3%24H%7D%24AS.png">    </p><p>生成对应材质球后，选择**Save Atlas to…**，并将贴图文件保存至某个文件夹。导出的Atlas如图：<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/Atlas_00001.jpg">    </p><p>最后选择CATS工具上方的Export Model导出模型，导出配置一下缩放：<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/export.jpg">    </p><hr><h2 id="5-Unity的导入"><a href="#5-Unity的导入" class="headerlink" title="5.Unity的导入"></a>5.Unity的导入</h2><p>正常新建一个工程，并导入Unity插件VRM-0.115.0_7e05，插件中包含了一些Shader，主要是还原VRM渲染效果的。<br>将刚才导出的.fbx模型文件直接连同Atlas贴图拖入Unity，养成好习惯，每个模型的贴图&amp;模型放在同一个文件夹。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/unity_floder.jpg"><br>将模型放进场景中，发现感觉怪怪的，这是因为材质设置的原因，有两种解决方式：    </p><ol><li><p>不使用插件的Shader，使用Standard的材质，但是将Rendering Mode修改为Cutout，将贴图拖入Albedo并调整合适的Alpha Cutoff来尽量裁剪网格。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/T(N_X%40AF(9P)%5D%7E%7BS_U%7BWD94.png">    </p></li><li><p>使用之前导入的插件，新建一个材质，将材质修改为<strong>UniGLTF–&gt;UniUnlit</strong>，并同样将Rendering Type修改为Cutout，即可得到一个跟Vroid类似的渲染效果。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/unity.jpg">    </p></li></ol><hr><h2 id="6-匹配模型骨架"><a href="#6-匹配模型骨架" class="headerlink" title="6.匹配模型骨架"></a>6.匹配模型骨架</h2><p>选中模型文件，修改模型骨架类型为类人型(Humanoid)，点击<strong>Apply</strong>，并在<code>Condigure...</code>中确认骨架分配是否OK，或进行需要的调整。<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/unity_1.jpg">    </p><p><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/unity_2.jpg">    </p><h2 id="7-动画的导入"><a href="#7-动画的导入" class="headerlink" title="7.动画的导入"></a>7.动画的导入</h2><p>动画导入就是老朋友Mixamo了，在网站上Download就行。</p>]]></content>
    
    
    <summary type="html">Unity开发避免不了3D模型的需求，个人美术能力有限，从blender撸一些小件还好，从零开始做人物模型暂时还是有点难为我了，所以只能先寻求他法，Vroid就是一个很好用的人物模型生成工具，这个软件可以一定程度降低对美术硬实力的要求，上手门槛低出模型效果却不错，但是Vroid导出的VRM文件如何很好地导入unity是个问题，中间也有不少坑，因此记录一下</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="Unity" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/Unity/"/>
    
    
    <category term="Unity" scheme="http://yoursite.com/tags/Unity/"/>
    
    <category term="Unity开发" scheme="http://yoursite.com/tags/Unity%E5%BC%80%E5%8F%91/"/>
    
    <category term="游戏开发" scheme="http://yoursite.com/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="Vroid" scheme="http://yoursite.com/tags/Vroid/"/>
    
  </entry>
  
  <entry>
    <title>基于Mqtt的城市智能路灯控制系统</title>
    <link href="http://yoursite.com/2022/02/17/MqttLightingServers/"/>
    <id>http://yoursite.com/2022/02/17/MqttLightingServers/</id>
    <published>2022-02-17T06:49:04.000Z</published>
    <updated>2023-11-01T18:00:08.526Z</updated>
    
    <content type="html"><![CDATA[<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>这是一个城市智能路灯控制系统的设计，实现功能主要为光线充足时不亮灯，当光线不足时开始检测，如果有人或者有声音便亮起路灯，这是自动模式，设备可通过手机APP切换为手动模式，在手动模式下用户可通过手机APP来实现对路灯的操控。<br><strong>本项目本身逻辑比较简单，硬件部分也是很常见的设计</strong>，与之前做过的项目大同小异，本质上还是传感器采集信息然后单片机负责进行判断和开关电路。因此这个项目的重点其实在于<code>Mqtt</code>的使用，之前的几个物联网设计中，手机端的实现主要是依靠第三方的点灯科技的接口，这种方式实现联网终究<strong>可玩性还是太低了</strong>，况且对于一个硬件电子爱好者来说，实现物联网仅局限于云智能也太拉跨了，<strong>因此学习了<code>AndroidStudio</code>开发<code>App</code>从而实现Mqtt的通信协来控制设备实现物联网，我个人认为这一个流程的实现才是真正的物联网开发。</strong></p><hr><h2 id="一、原件清单"><a href="#一、原件清单" class="headerlink" title="一、原件清单"></a>一、原件清单</h2><ul><li>Esp8266NodeMCU*1  </li><li>人体热释红外传感器*1  </li><li>音量传感器*1  </li><li>光敏电阻传感器模块*1 </li><li>SSD1306显示屏*1 </li><li>杜邦线*1 </li><li>5V一路继电器  </li><li>18650锂电池*2  </li><li>三极管*1</li><li>杜邦线 若干<br><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gzgkbnlhzaj30h30daqaj.jpg" alt="硬件连接.png"></li></ul><hr><h2 id="二、硬件连接"><a href="#二、硬件连接" class="headerlink" title="二、硬件连接"></a>二、硬件连接</h2><table><thead><tr><th>nodeMCU</th><th>ssd1306</th><th>光敏传感器</th><th>人体热释传感器</th><th>声音传感器</th><th>5V继电器</th><th>LED灯泡</th><th>NPN三极管</th><th>18650电源</th></tr></thead><tbody><tr><td>D6</td><td>SDA</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D7</td><td>SCL</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D0</td><td></td><td>DO</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D2</td><td></td><td></td><td></td><td>OUT</td><td></td><td></td><td></td><td></td></tr><tr><td>D8</td><td></td><td></td><td>OUT</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D2</td><td></td><td></td><td></td><td></td><td></td><td></td><td>基极</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>IN</td><td></td><td>集电极</td><td></td></tr><tr><td>VCC</td><td>VCC</td><td>VCC</td><td>VCC</td><td>VCC</td><td>DC+</td><td></td><td>发射极</td><td></td></tr><tr><td>GND</td><td>GND</td><td>GND</td><td>GND</td><td>GND</td><td>DC-</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>COM1</td><td></td><td></td><td>+</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>-</td><td></td><td>-</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>NO</td><td>+</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><hr><h2 id="三、原理图-amp-流程图"><a href="#三、原理图-amp-流程图" class="headerlink" title="三、原理图&amp;流程图"></a>三、原理图&amp;流程图</h2><p><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gzgkcslvbfj30mq0cemxr.jpg" alt="Mqtt城市智能路灯.png"><br>总体设计原理图  </p><p><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gzgkpq5012j30g30cqmxu.jpg" alt="Mqtt城市智能路灯软件流程图.png"><br>软件流程图  </p><hr><h2 id="四、程序代码"><a href="#四、程序代码" class="headerlink" title="四、程序代码"></a>四、程序代码</h2><p>硬件程序：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SSD1306Wire.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ESP8266WiFi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;PubSubClient.h&gt;</span></span></span><br><span class="line">WiFiClient espClient;</span><br><span class="line"><span class="function">PubSubClient <span class="title">client</span> <span class="params">(espClient)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* wifissid=<span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* password=<span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* mqtt_server=<span class="string">&quot;xxx.xxx.xxx.xxx&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* mqtt_id=<span class="string">&quot;isNineSun_ESP&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* Mqtt_sub_topic=<span class="string">&quot;pub_ywt&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* Mqtt_pub_topic=<span class="string">&quot;sub_ywt&quot;</span>;</span><br><span class="line"><span class="keyword">long</span> lastMsg=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> MIC = <span class="number">4</span>;        <span class="comment">// D0 麦克风引脚连接开发板数字接口 2</span></span><br><span class="line"><span class="keyword">int</span> LED = <span class="number">0</span>;        <span class="comment">// LED  正极连接开发板数字接口3</span></span><br><span class="line"><span class="keyword">int</span> HC = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">int</span> D_in=<span class="number">16</span>;</span><br><span class="line"><span class="keyword">int</span> VALOR;        <span class="comment">// DO变量值</span></span><br><span class="line"><span class="keyword">int</span> LEDDO;       <span class="comment">// LED变量 </span></span><br><span class="line"><span class="keyword">int</span> HoneWai;</span><br><span class="line"><span class="keyword">int</span> Lighting; </span><br><span class="line"><span class="keyword">bool</span> auto_mode=<span class="number">1</span>,led_mode=<span class="number">1</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> wu_you[][<span class="number">32</span>]=&#123;<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x20</span>,<span class="number">0x42</span>,<span class="number">0x10</span>,<span class="number">0x42</span>,<span class="number">0x0C</span>,<span class="number">0xC2</span>,<span class="number">0x03</span>,<span class="number">0x7E</span>,<span class="number">0x00</span>,<span class="number">0x42</span>,<span class="number">0x00</span>,<span class="number">0xC2</span>,<span class="number">0x3F</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*无0*/</span></span><br><span class="line">                 <span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x01</span>,<span class="number">0x84</span>,<span class="number">0x00</span>,<span class="number">0xE4</span>,<span class="number">0xFF</span>,<span class="number">0x3C</span>,<span class="number">0x09</span>,<span class="number">0x27</span>,<span class="number">0x09</span>,<span class="number">0x24</span>,<span class="number">0x09</span>,<span class="number">0x24</span>,<span class="number">0x09</span>,<span class="number">0x24</span>,<span class="number">0x49</span>,<span class="number">0x24</span>,<span class="number">0x89</span>,<span class="number">0xE4</span>,<span class="number">0x7F</span>,<span class="number">0x04</span>,<span class="number">0x00</span>,<span class="number">0x04</span>,<span class="number">0x00</span>,<span class="number">0x04</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*有0*/</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> ren[][<span class="number">32</span>]=&#123;<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x20</span>,<span class="number">0x00</span>,<span class="number">0x10</span>,<span class="number">0x00</span>,<span class="number">0x0C</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0xC0</span>,<span class="number">0x00</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0xC0</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x0C</span>,<span class="number">0x00</span>,<span class="number">0x10</span>,<span class="number">0x00</span>,<span class="number">0x20</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*人0*/</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> sheng[][<span class="number">32</span>]=&#123;<span class="number">0x04</span>,<span class="number">0x80</span>,<span class="number">0x14</span>,<span class="number">0x60</span>,<span class="number">0xD4</span>,<span class="number">0x1F</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0xDF</span>,<span class="number">0x03</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0x54</span>,<span class="number">0x02</span>,<span class="number">0xD4</span>,<span class="number">0x03</span>,<span class="number">0x14</span>,<span class="number">0x00</span>,<span class="number">0x04</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*声0*/</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> guang[][<span class="number">32</span>]=&#123;<span class="number">0x40</span>,<span class="number">0x80</span>,<span class="number">0x40</span>,<span class="number">0x80</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x44</span>,<span class="number">0x20</span>,<span class="number">0x58</span>,<span class="number">0x18</span>,<span class="number">0xC0</span>,<span class="number">0x07</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0xC0</span>,<span class="number">0x3F</span>,<span class="number">0x50</span>,<span class="number">0x40</span>,<span class="number">0x48</span>,<span class="number">0x40</span>,<span class="number">0x46</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x78</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*光0*/</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">uint8_t</span> image1[] PROGMEM =&#123;</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0xE0</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xF0</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xFC</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xFF</span>,<span class="number">0xF1</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xFF</span>,<span class="number">0xE4</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x9E</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0x60</span>,<span class="number">0x3E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7E</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0x0C</span>,<span class="number">0xBC</span>,<span class="number">0x39</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0x9C</span>,<span class="number">0x99</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0xDC</span>,<span class="number">0xA3</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7E</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0xFF</span>,<span class="number">0xF6</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,</span><br><span class="line"><span class="number">0xDF</span>,<span class="number">0xF6</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xCE</span>,<span class="number">0x79</span>,<span class="number">0xDE</span>,<span class="number">0xF6</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xDE</span>,<span class="number">0xF6</span>,<span class="number">0x07</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xFF</span>,<span class="number">0xF6</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xFF</span>,<span class="number">0xB6</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xE0</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0xDE</span>,<span class="number">0xBF</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xDC</span>,<span class="number">0xBF</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x1C</span>,<span class="number">0x80</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x03</span>,<span class="number">0x3E</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xC3</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0x1C</span>,<span class="number">0x38</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xFB</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0x1E</span>,<span class="number">0x3C</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0x1E</span>,<span class="number">0x3C</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,</span><br><span class="line"><span class="number">0xF0</span>,<span class="number">0x3E</span>,<span class="number">0x3E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xDF</span>,<span class="number">0x3D</span>,<span class="number">0xF0</span>,<span class="number">0xFE</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0x0F</span>,<span class="number">0x3C</span>,<span class="number">0xF0</span>,<span class="number">0xFE</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0x67</span>,<span class="number">0x3C</span>,<span class="number">0xF0</span>,<span class="number">0xFE</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x9E</span>,<span class="number">0xF3</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0xFE</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x86</span>,<span class="number">0xF3</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0x3E</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x32</span>,<span class="number">0xC3</span>,<span class="number">0x3F</span>,<span class="number">0xF0</span>,<span class="number">0x1E</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x1F</span>,<span class="number">0xFC</span>,<span class="number">0x1C</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x70</span>,<span class="number">0x70</span>,<span class="number">0x40</span>,<span class="number">0xFF</span>,<span class="number">0x01</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFE</span>,<span class="number">0xFF</span>,<span class="number">0x77</span>,<span class="number">0xFF</span>,<span class="number">0x77</span>,<span class="number">0x0C</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xFB</span>,<span class="number">0xFF</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x03</span>,<span class="number">0xE0</span>,<span class="number">0xFF</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x38</span>,<span class="number">0xEE</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xCE</span>,<span class="number">0xF0</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x7C</span>,<span class="number">0x9E</span>,<span class="number">0x80</span>,<span class="number">0x7C</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,</span><br><span class="line"><span class="number">0x9E</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0x9C</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xC0</span>,<span class="number">0x00</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0x00</span>,<span class="number">0x0E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*C:\Users\NineSun\Desktop\未标题-1.bmp0*/</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">uint8_t</span> image2[] PROGMEM =&#123;</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x38</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC0</span>,<span class="number">0x79</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xF8</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCE</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x78</span>,<span class="number">0xFE</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xF8</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0xBC</span>,<span class="number">0x7F</span>,<span class="number">0xF2</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0xBE</span>,<span class="number">0x3F</span>,<span class="number">0xEF</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x3E</span>,<span class="number">0x30</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x3E</span>,<span class="number">0x0E</span>,<span class="number">0xDE</span>,<span class="number">0x1D</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xCE</span>,<span class="number">0xCC</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0xEF</span>,<span class="number">0xD1</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0xFF</span>,<span class="number">0xDF</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0xFF</span>,<span class="number">0xDF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0x7F</span>,<span class="number">0xFB</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,</span><br><span class="line"><span class="number">0x7F</span>,<span class="number">0xFB</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x6F</span>,<span class="number">0xFB</span>,<span class="number">0x07</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0x6F</span>,<span class="number">0xFB</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,<span class="number">0x7F</span>,<span class="number">0xFB</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xDF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC7</span>,<span class="number">0x7B</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xDF</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC7</span>,<span class="number">0x7B</span>,<span class="number">0x00</span>,<span class="number">0xEF</span>,<span class="number">0xDF</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC0</span>,<span class="number">0x79</span>,<span class="number">0x00</span>,<span class="number">0xEE</span>,<span class="number">0xDF</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x0E</span>,<span class="number">0xC0</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC0</span>,<span class="number">0x01</span>,<span class="number">0x1F</span>,<span class="number">0x78</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xE1</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0x0E</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0x1F</span>,<span class="number">0x1E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0x1F</span>,<span class="number">0x3E</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,</span><br><span class="line"><span class="number">0x7C</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xFF</span>,<span class="number">0x1E</span>,<span class="number">0x7C</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x07</span>,<span class="number">0x1E</span>,<span class="number">0x7C</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0x3B</span>,<span class="number">0x1E</span>,<span class="number">0x7C</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xCF</span>,<span class="number">0xF9</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xC3</span>,<span class="number">0xF9</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0x1F</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xB9</span>,<span class="number">0xE1</span>,<span class="number">0x1F</span>,<span class="number">0x7C</span>,<span class="number">0x1F</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xBC</span>,<span class="number">0x80</span>,<span class="number">0x0F</span>,<span class="number">0x7F</span>,<span class="number">0x0E</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x3C</span>,<span class="number">0x38</span>,<span class="number">0xA0</span>,<span class="number">0xFF</span>,<span class="number">0x00</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0x06</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xBF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0x01</span>,<span class="number">0xF0</span>,<span class="number">0xFF</span>,<span class="number">0x07</span>,<span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x1C</span>,<span class="number">0xF7</span>,<span class="number">0xFF</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>,<span class="number">0x3E</span>,<span class="number">0x6F</span>,<span class="number">0xFC</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x3C</span>,<span class="number">0xFC</span>,<span class="number">0x3F</span>,<span class="number">0x4F</span>,<span class="number">0x40</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFC</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,</span><br><span class="line"><span class="number">0x5F</span>,<span class="number">0x80</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xFC</span>,<span class="number">0xFF</span>,<span class="number">0x3F</span>,<span class="number">0x4E</span>,<span class="number">0x80</span>,<span class="number">0x3F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0xFF</span>,<span class="number">0x1F</span>,<span class="number">0x60</span>,<span class="number">0x80</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0xFF</span>,<span class="number">0x07</span>,<span class="number">0x30</span>,<span class="number">0x00</span>,<span class="number">0x07</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*C:\Users\NineSun\Desktop\未标题-1.bmp0*/</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I2C_ADDR = <span class="number">0x3c</span>;              <span class="comment">// oled屏幕的I2c地址</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDA_PIN 12                       <span class="comment">// SDA引脚，默认gpio12</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCL_PIN 13                      <span class="comment">// SCL引脚，默认gpio13</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">SSD1306Wire <span class="title">oled</span><span class="params">(I2C_ADDR, SDA_PIN, SCL_PIN)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(MIC, INPUT);      <span class="comment">// 麦克风输入口</span></span><br><span class="line">  <span class="built_in">pinMode</span>(LED, OUTPUT);     <span class="comment">// LED输出口</span></span><br><span class="line">  <span class="built_in">pinMode</span>(HC, INPUT);     <span class="comment">// 红外输入</span></span><br><span class="line">  <span class="built_in">pinMode</span>(D_in, INPUT);     <span class="comment">// 光敏输入</span></span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>,OUTPUT);</span><br><span class="line"></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">setup_wifi</span>();</span><br><span class="line">  client.<span class="built_in">setServer</span>(mqtt_server,<span class="number">1883</span>);</span><br><span class="line">  client.<span class="built_in">setCallback</span>(callback);</span><br><span class="line"></span><br><span class="line">  oled.<span class="built_in">init</span>();</span><br><span class="line">  oled.<span class="built_in">flipScreenVertically</span>();        <span class="comment">// 设置屏幕翻转</span></span><br><span class="line">  oled.<span class="built_in">setContrast</span>(<span class="number">255</span>);              <span class="comment">// 设置屏幕亮度</span></span><br><span class="line">  <span class="built_in">drawRect</span>();                         <span class="comment">// 测试屏幕显示</span></span><br><span class="line">  oled.<span class="built_in">clear</span>(); </span><br><span class="line">  oled.<span class="built_in">display</span>();       <span class="comment">// 清除屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!client.<span class="built_in">connected</span>())&#123;</span><br><span class="line">    <span class="built_in">reconnect</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  client.<span class="built_in">loop</span>();</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(auto_mode)&#123;</span><br><span class="line">    oled.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">Auto_Mode</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    oled.<span class="built_in">clear</span>();</span><br><span class="line">    oled.<span class="built_in">drawFastImage</span>(<span class="number">30</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">64</span>, image2);</span><br><span class="line">    oled.<span class="built_in">display</span>();</span><br><span class="line">    <span class="built_in">manual_mode</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">  &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Auto_Mode</span><span class="params">()</span></span>&#123;</span><br><span class="line">  oled.<span class="built_in">setFont</span>(ArialMT_Plain_16);       <span class="comment">// 设置字体</span></span><br><span class="line">  oled.<span class="built_in">println</span>(<span class="string">&quot;AUTO&quot;</span>);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, sheng[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">1</span>, <span class="number">16</span>, <span class="number">16</span>, ren[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, guang[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[VALOR]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">1</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[HoneWai]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[!Lighting]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">45</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">64</span>, image1);</span><br><span class="line">  oled.<span class="built_in">display</span>();                       <span class="comment">// 将缓存里的文字在屏幕上显示</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">  oled.<span class="built_in">display</span>();</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  VALOR = <span class="built_in">digitalRead</span>(MIC);   <span class="comment">// 数字读取DO</span></span><br><span class="line">  HoneWai = <span class="built_in">digitalRead</span>(HC); </span><br><span class="line">  Lighting =  <span class="built_in">digitalRead</span>(D_in);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(Lighting==HIGH)&#123;</span><br><span class="line">    oled.<span class="built_in">clear</span>();</span><br><span class="line">       <span class="keyword">if</span> (VALOR == HIGH||HoneWai == HIGH)&#123;</span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, sheng[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">1</span>, <span class="number">16</span>, <span class="number">16</span>, ren[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">1</span>, <span class="number">21</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, guang[<span class="number">0</span>]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[VALOR]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">1</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[HoneWai]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">20</span>*<span class="number">0</span>, <span class="number">21</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, wu_you[!Lighting]); <span class="comment">// 将要显示的文字写入缓存</span></span><br><span class="line"></span><br><span class="line">             oled.<span class="built_in">drawFastImage</span>(<span class="number">45</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">64</span>, image1);</span><br><span class="line">             </span><br><span class="line">             oled.<span class="built_in">display</span>();                       <span class="comment">// 将缓存里的文字在屏幕上显示</span></span><br><span class="line">             <span class="built_in">digitalWrite</span>(LED, HIGH);</span><br><span class="line">             <span class="built_in">delay</span>(<span class="number">5000</span>); </span><br><span class="line">           &#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;</span><br><span class="line">             <span class="built_in">digitalWrite</span>(LED, LOW);</span><br><span class="line">           &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(LED, LOW);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manual_mode</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(LED, led_mode?HIGH:LOW);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//开机动画</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawRect</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int16_t</span> i=<span class="number">0</span>; i&lt;oled.<span class="built_in">getHeight</span>()/<span class="number">2</span>; i+=<span class="number">2</span>) &#123;</span><br><span class="line">    oled.<span class="built_in">drawRect</span>(i, i, oled.<span class="built_in">getWidth</span>()<span class="number">-2</span>*i, oled.<span class="built_in">getHeight</span>()<span class="number">-2</span>*i);</span><br><span class="line">    oled.<span class="built_in">display</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*****************************wifi程序*****************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup_wifi</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Serial.<span class="built_in">println</span>();</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Connecting to&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(wifissid);</span><br><span class="line">  WiFi.<span class="built_in">begin</span>(wifissid,password);</span><br><span class="line">  <span class="keyword">while</span>(WiFi.<span class="built_in">status</span>()!=WL_CONNECTED)&#123;</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">    Serial.<span class="built_in">print</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;WiFi connected!&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;IP Address:&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(WiFi.<span class="built_in">localIP</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callback</span><span class="params">(<span class="keyword">char</span>* topic,byte* payload,<span class="keyword">unsigned</span> <span class="keyword">int</span> length)</span></span>&#123;</span><br><span class="line">  String msg=<span class="string">&quot;&quot;</span>;</span><br><span class="line">  String Led_set=<span class="string">&quot;&quot;</span>;</span><br><span class="line">  String auto_set=<span class="string">&quot;&quot;</span>;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;Message arrived&#123;&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(topic);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">    msg+=(<span class="keyword">char</span>)payload[i];</span><br><span class="line">  &#125;</span><br><span class="line">  Serial.<span class="built_in">println</span>(msg);</span><br><span class="line">  <span class="keyword">if</span>(msg.<span class="built_in">indexOf</span>(<span class="string">&quot;led&quot;</span>))&#123;</span><br><span class="line">    Led_set = msg.<span class="built_in">substring</span>(msg.<span class="built_in">indexOf</span>(<span class="string">&quot;led\&quot;:&quot;</span>)+<span class="number">5</span>,msg.<span class="built_in">indexOf</span>(<span class="string">&quot;&#125;&quot;</span>));</span><br><span class="line">    led_mode = Led_set.<span class="built_in">toInt</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(msg.<span class="built_in">indexOf</span>(<span class="string">&quot;auto&quot;</span>))&#123;</span><br><span class="line">    auto_set = msg.<span class="built_in">substring</span>(msg.<span class="built_in">indexOf</span>(<span class="string">&quot;auto\&quot;:&quot;</span>)+<span class="number">6</span>,msg.<span class="built_in">indexOf</span>(<span class="string">&quot;&#125;&quot;</span>));</span><br><span class="line">    auto_mode = auto_set.<span class="built_in">toInt</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reconnect</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(!client.<span class="built_in">connected</span>())&#123;</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;Attempting MQTT connection...&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(client.<span class="built_in">connect</span>(mqtt_id))&#123;</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Connected!&quot;</span>);</span><br><span class="line">      client.<span class="built_in">publish</span>(Mqtt_pub_topic,<span class="string">&quot;设备已上线&quot;</span>);</span><br><span class="line"></span><br><span class="line">      client.<span class="built_in">subscribe</span>(Mqtt_sub_topic,<span class="number">1</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Failed,rc=&quot;</span>);</span><br><span class="line">      Serial.<span class="built_in">println</span>(client.<span class="built_in">state</span>());</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;try again in 5 seconds&quot;</span>);</span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">50000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>代码中的中文汉字用到了一个叫 <code>PCtoLCD2002</code> 的软件,这个软件可以很方便的将汉字转化成对应的字形码来输出，这里用的是<code>16*16</code>的字宽字长；**</li><li>关于Mqtt通信协议的获取的相关函数写在了wifi相关里面；</li><li>关于<code>const char* mqtt_server=&quot;xxx.xxx.xxx.xxx&quot;;</code>这句话中的<code>xxx.xxx.xxx.xxx</code>应该填入你的物联网服务器公网地址，关于如何搭建物联网服务器，我有计划重新开一篇帖子来说，非常简单，如果你是学生的话更能用几十块钱的价格买到非常便宜的云服务器，平时学习使用是足够了的。</li><li><code>client.setServer(mqtt_server,1883);</code>一句中的<code>1883</code>是服务器端口号，通常设置为1883；  </li></ul><p>接下来是软件方面的代码，软件开发使用<strong>AndroidStudio</strong>进行，首先需要添加MQTT的依赖库，然后app还需要获取一些必要的权限，这些都是必须要配置的：  </p><p><strong>首先</strong>，在bulid.gradle 里面最后的依赖那里复制这段代码（在那一排“implementation”后面加）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//导入Mqtt环境依赖</span><br><span class="line">    implementation &#x27;org.eclipse.paho:org.eclipse.paho.client.mqttv3:1.1.1&#x27;</span><br><span class="line">    implementation &#x27;org.eclipse.paho:org.eclipse.paho.android.service:1.1.1&#x27;</span><br></pre></td></tr></table></figure><p>然后软件点击右上角的sync now，进行同步，建议科学上网，就能正常加载包了;</p><p><strong>然后</strong>，需要配置app需要的一些权限：找到<code>AndroidManifest.xml</code>文件，在这个文件中加入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Permissions the Application Requires --&gt;</span><br><span class="line">   &lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot; /&gt;</span><br><span class="line">   &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">   &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;</span><br><span class="line"></span><br><span class="line">   &lt;!--&lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot; /&gt;--&gt;</span><br><span class="line">   &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">   &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</span><br></pre></td></tr></table></figure><p>为防止有的同学完全没接触过as开发，特别说明，这段直接添加到原代码的<code> &lt;application</code>之前就可以了，就在前面几行，很容易找到。</p><p><strong>最后</strong>，还是在这个文件中，在代码末尾<code>&lt;/activity&gt;</code>这句话的后面，紧跟着插入一段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Mqtt Service --&gt;</span><br><span class="line">       &lt;service android:name=&quot;org.eclipse.paho.android.service.MqttService&quot;&gt;</span><br><span class="line">       &lt;/service&gt;</span><br></pre></td></tr></table></figure><p>来引入Mqt的服务。<br><strong>完成之后，前期的配置就完成了可以愉快的写代码了(≧∇≦)ﾉ。</strong><br>程序逻辑代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">package com.example.mqtt_study;</span><br><span class="line"></span><br><span class="line">import androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.Button;</span><br><span class="line">import android.widget.ImageButton;</span><br><span class="line">import android.widget.ImageView;</span><br><span class="line">import android.widget.LinearLayout;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line">import android.widget.Switch;</span><br><span class="line"></span><br><span class="line">import org.eclipse.paho.android.service.MqttAndroidClient;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.IMqttActionListener;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.IMqttDeliveryToken;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.IMqttMessageListener;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.IMqttToken;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.MqttCallbackExtended;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.MqttConnectOptions;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.MqttException;</span><br><span class="line">import org.eclipse.paho.client.mqttv3.MqttMessage;</span><br><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    MqttAndroidClient mqttAndroidClient;//建立Client客户端实例</span><br><span class="line"></span><br><span class="line">    final String serverUri = &quot;tcp://101.43.207.139:1883&quot;;//服务器地址</span><br><span class="line"></span><br><span class="line">    String clientId = &quot;isNineSun_android&quot;;//客户端标识，可以随便起，保证不重复即可</span><br><span class="line">    final String subscriptionTopic = &quot;sub_ywt&quot;;//订阅的主题</span><br><span class="line">    final String publishTopic = &quot;pub_ywt&quot;;</span><br><span class="line"></span><br><span class="line">    //UI变量</span><br><span class="line">    private ImageButton button1,button2;</span><br><span class="line">    private boolean light,auto;</span><br><span class="line">    private TextView text;</span><br><span class="line">    private ImageView image;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        UI_init();</span><br><span class="line">        Mqtt_init();</span><br><span class="line"></span><br><span class="line">        button1.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View view) &#123;</span><br><span class="line">                light=!light;</span><br><span class="line">                String publishMsg=&quot;&#123;\&quot;set_led\&quot;:&quot;+(light?&quot;1&quot;:&quot;0&quot;)+&quot;&#125;&quot;;</span><br><span class="line">                publishMessage(publishMsg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button2.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View view) &#123;</span><br><span class="line">                auto=!auto;</span><br><span class="line">                String publishMsg=&quot;&#123;\&quot;set_auto\&quot;:&quot;+(auto?&quot;1&quot;:&quot;0&quot;)+&quot;&#125;&quot;;</span><br><span class="line">                publishMessage(publishMsg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void UI_init()&#123;</span><br><span class="line">        button1 = findViewById(R.id.but_1);</span><br><span class="line">        button2 = findViewById(R.id.but_2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void Mqtt_init()&#123;</span><br><span class="line">        //新建Client实例</span><br><span class="line">        //clientId = clientId + System.currentTimeMillis();//在clientId即客户端标识后面加上时间戳来保证唯一性</span><br><span class="line">        mqttAndroidClient = new MqttAndroidClient(getApplicationContext(), serverUri, clientId);</span><br><span class="line">        //新建回调函数</span><br><span class="line">        mqttAndroidClient.setCallback(new MqttCallbackExtended() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            //连接完成</span><br><span class="line">            public void connectComplete(boolean reconnect, String serverURI) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">            //失去连接</span><br><span class="line">            @Override</span><br><span class="line">            public void connectionLost(Throwable cause) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">            //信息送达</span><br><span class="line">            @Override</span><br><span class="line">            public void messageArrived(String topic, MqttMessage message) throws Exception &#123;</span><br><span class="line">                String msg = new String(message.getPayload());</span><br><span class="line">                //String T_val=msg.substring(msg.indexOf(&quot;&#123;temperature:&quot;),msg.indexOf(&quot;&#125;&quot;));</span><br><span class="line">                makeToast(msg);</span><br><span class="line">                text.setText(msg);</span><br><span class="line">                image.setImageAlpha(1);</span><br><span class="line">            &#125;</span><br><span class="line">            //推送完成</span><br><span class="line">            @Override</span><br><span class="line">            public void deliveryComplete(IMqttDeliveryToken token) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        //连接设置、是否自动重连、是否清理Session</span><br><span class="line">        MqttConnectOptions mqttConnectOptions = new MqttConnectOptions();</span><br><span class="line">        mqttConnectOptions.setAutomaticReconnect(true);</span><br><span class="line">        mqttConnectOptions.setCleanSession(false);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //正式开始建立连接</span><br><span class="line">        try &#123;</span><br><span class="line">            //addToHistory(&quot;Connecting to &quot; + serverUri);</span><br><span class="line">            mqttAndroidClient.connect(mqttConnectOptions, null, new IMqttActionListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onSuccess(IMqttToken asyncActionToken) &#123;</span><br><span class="line">                    makeToast(&quot;连接成功&quot;);</span><br><span class="line">                    subscribeToTopic();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public void onFailure(IMqttToken asyncActionToken, Throwable exception) &#123;</span><br><span class="line">                    makeToast(&quot;连接失败&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; catch (MqttException ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void subscribeToTopic()&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            //开始订阅</span><br><span class="line">            mqttAndroidClient.subscribe(subscriptionTopic, 0, null, new IMqttActionListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onSuccess(IMqttToken asyncActionToken) &#123;</span><br><span class="line">                    makeToast(&quot;成功订阅&quot;+subscriptionTopic);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public void onFailure(IMqttToken asyncActionToken, Throwable exception) &#123;</span><br><span class="line">                    makeToast(&quot;未能订阅&quot;+subscriptionTopic);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125; catch (MqttException ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void publishMessage(String publishMessage)&#123;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            MqttMessage message = new MqttMessage();</span><br><span class="line">            message.setPayload(publishMessage.getBytes());</span><br><span class="line">            mqttAndroidClient.publish(publishTopic, message);</span><br><span class="line">            if(!mqttAndroidClient.isConnected())&#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (MqttException e) &#123;</span><br><span class="line">            System.err.println(&quot;Error Publishing: &quot; + e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void makeToast(String str)&#123;</span><br><span class="line">        Toast.makeText(MainActivity.this,str,Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>软件的布局文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:orientation=&quot;vertical&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:visibility=&quot;visible&quot;&gt;</span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">                android:layout_height=&quot;20sp&quot;</span><br><span class="line">                android:src=&quot;@drawable/online&quot;</span><br><span class="line">                android:alpha=&quot;0&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;/ImageView&gt;</span><br><span class="line">            &lt;TextView</span><br><span class="line">                android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">                android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">                android:text=&quot;&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;/TextView&gt;</span><br><span class="line">        &lt;/LinearLayout&gt;</span><br><span class="line">        &lt;ImageButton</span><br><span class="line">            android:layout_width=&quot;100dp&quot;</span><br><span class="line">            android:layout_height=&quot;100dp&quot;</span><br><span class="line">            android:layout_gravity=&quot;center&quot;</span><br><span class="line">            android:layout_marginTop=&quot;200dp&quot;</span><br><span class="line">            android:id=&quot;@+id/but_1&quot;</span><br><span class="line">            android:backgroundTint=&quot;@color/white&quot;</span><br><span class="line">            android:src=&quot;@drawable/power&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/ImageButton&gt;</span><br><span class="line"></span><br><span class="line">        &lt;ImageButton</span><br><span class="line">            android:layout_width=&quot;100dp&quot;</span><br><span class="line">            android:layout_height=&quot;100dp&quot;</span><br><span class="line">            android:layout_gravity=&quot;center&quot;</span><br><span class="line">            android:id=&quot;@+id/but_2&quot;</span><br><span class="line">            android:backgroundTint=&quot;@color/white&quot;</span><br><span class="line">            android:src=&quot;@drawable/swt&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/ImageButton&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br></pre></td></tr></table></figure><p>程序代码我用了自己写的模板来节省开发时间，如果有人对我的模板感兴趣可以去我的github页面去拿，欢迎使用<a href="https://github.com/isNineSun/isNineSun.github.io">Mqtt模板代码</a>！  </p><hr><h2 id="五、实物图"><a href="#五、实物图" class="headerlink" title="五、实物图"></a>五、实物图</h2><p>实物展示：<br><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gzgmkr2icdj30gy0ddwkp.jpg" alt="硬件.png"><br><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gzgmkr2um1j30gv0owwiq.jpg" alt="软件.png"></p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这次设计的硬件方面与之前的物联网设计大同小异，但是在Mqtt的配置方面学到了很多，也加深了对互联网概念的理解，以后有机会希望还能更深入更底层的去做物联网相关的开发，除此之外，AndroidStudio的开发我暂时也只是初窥门径而已，希望能更深入的掌握这个强大的工具，之后有机会我可能会做一些更偏软或者纯软的项目来加深对as开发的掌握。</p>]]></content>
    
    
    <summary type="html">这是一个城市智能路灯控制系统的设计，实现功能主要为光线充足时不亮灯，当光线不足时开始检测，如果有人或者有声音便亮起路灯，这是自动模式，设备可通过手机APP切换为手动模式，在手动模式下用户可通过手机APP来实现对路灯的操控。</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="嵌入式" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="嵌入式开发" scheme="http://yoursite.com/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="Mqtt" scheme="http://yoursite.com/tags/Mqtt/"/>
    
  </entry>
  
  <entry>
    <title>Esp8266配置Wifi连接模板</title>
    <link href="http://yoursite.com/2022/02/01/ESP8266_template/"/>
    <id>http://yoursite.com/2022/02/01/ESP8266_template/</id>
    <published>2022-02-01T09:58:04.000Z</published>
    <updated>2023-11-01T17:53:27.363Z</updated>
    
    <content type="html"><![CDATA[<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ESP8266WiFi.h&gt;</span>        </span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* ssid=<span class="string">&quot;WiFi名称&quot;</span>;      </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* password=<span class="string">&quot;WiFi密码&quot;</span>;         </span><br><span class="line">                                            </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);          <span class="comment">// 启动串口通讯</span></span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;                                 </span><br><span class="line">  WiFi.<span class="built_in">begin</span>(ssid,password);</span><br><span class="line">    <span class="keyword">while</span>(WiFi.<span class="built_in">status</span>()!= WL_CONNECTED)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">        Serial.<span class="built_in">print</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// WiFi连接成功后将通过串口监视器输出连接成功信息 </span></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&#x27;\n&#x27;</span>);                     <span class="comment">// WiFi连接成功后</span></span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Connected to &quot;</span>);            <span class="comment">// NodeMCU将通过串口监视器输出。</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(WiFi.<span class="built_in">SSID</span>());              <span class="comment">// 连接的WiFI名称</span></span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;IP address:\t&quot;</span>);            <span class="comment">// 以及</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(WiFi.<span class="built_in">localIP</span>());           <span class="comment">// NodeMCU的IP地址</span></span><br><span class="line">  &#125;  </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;                                   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">这是一个ESP8266连接wifi的模板，几乎连接wifi都会用到这个代码，因此在这里做个记录。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="模板记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="记录" scheme="http://yoursite.com/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>基于ESP的农业气象监测站</title>
    <link href="http://yoursite.com/2022/01/23/AgricultureMonitor/"/>
    <id>http://yoursite.com/2022/01/23/AgricultureMonitor/</id>
    <published>2022-01-23T11:01:04.000Z</published>
    <updated>2023-11-01T17:27:59.952Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、原件清单"><a href="#一、原件清单" class="headerlink" title="一、原件清单"></a>一、原件清单</h2><ul><li>esp8266 node-mcu*1  </li><li>ssd1302 oled显示屏*1</li><li>dht11温湿度传感器*1</li><li>bmp280气压传感器*1</li><li>风速传感器（淘宝店铺：<a href="ilovemcu.taobao.com/">风速传感器的店铺</a>)  </li><li>2pin接线端子*1</li><li>杜邦线 若干  </li></ul><hr><h2 id="二、硬件连接"><a href="#二、硬件连接" class="headerlink" title="二、硬件连接"></a>二、硬件连接</h2><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gynqmp1852j310x0k4qgr.jpg" alt="连线图.png"><br>连线图  </p><table><thead><tr><th>NodeMCU</th><th>ssd1306</th><th>dht11</th><th>BMP280</th><th>风速传感器</th></tr></thead><tbody><tr><td>D0</td><td></td><td></td><td>SCL</td><td></td></tr><tr><td>D1</td><td>SCL</td><td></td><td></td><td></td></tr><tr><td>D2</td><td>SDA</td><td></td><td></td><td></td></tr><tr><td>D3</td><td></td><td></td><td></td><td></td></tr><tr><td>D4</td><td></td><td>S</td><td></td><td></td></tr><tr><td>D5</td><td></td><td></td><td>SDO</td><td></td></tr><tr><td>D6</td><td></td><td></td><td>CSB</td><td></td></tr><tr><td>D7</td><td></td><td></td><td>SDA</td><td></td></tr><tr><td>A0</td><td></td><td></td><td></td><td>棕色信号线</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>PS：各个模块的VCC和GNG端口皆并联在由NodeMCU引出的3v3和gnd上，风速传感器的蓝色线为gnd线，连接在NodeMCU的GND端口上</strong></td><td></td><td></td><td></td><td></td></tr></tbody></table><hr><h2 id="三、原理框图"><a href="#三、原理框图" class="headerlink" title="三、原理框图"></a>三、原理框图</h2><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gynsdcctwnj30lf0bp0ti.jpg" alt="农业气象监测站原理图.png">  </p><p>通过wifi的方式来将数据传回手机。</p><hr><h2 id="四、程序代码"><a href="#四、程序代码" class="headerlink" title="四、程序代码"></a>四、程序代码</h2><p>废话少说直接上代码  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Adafruit_Sensor.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Adafruit_BMP280.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dht11.h&gt;</span><span class="comment">//引入DHT11库</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SSD1306Wire.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLINKER_WIFI</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Blinker.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> temNumber <span class="meta-string">&quot;num-gpc&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> humNumber <span class="meta-string">&quot;num-ia5&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> windNumber <span class="meta-string">&quot;num-zb4&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AirNumber <span class="meta-string">&quot;num-3zw&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> auth[] = <span class="string">&quot;c2b25ef0c332&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> ssid[] = <span class="string">&quot;皇室家族Family&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> pswd[] = <span class="string">&quot;sunlisunrusunxu@&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">BlinkerNumber <span class="title">Tem</span><span class="params">(temNumber)</span></span>;</span><br><span class="line"><span class="function">BlinkerNumber <span class="title">Hum</span><span class="params">(humNumber)</span></span>;</span><br><span class="line"><span class="function">BlinkerNumber <span class="title">Wind</span><span class="params">(windNumber)</span></span>;</span><br><span class="line"><span class="function">BlinkerNumber <span class="title">Air</span><span class="params">(AirNumber)</span></span>;</span><br><span class="line"></span><br><span class="line">dht11 DHT11;<span class="comment">//定义传感器类型</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DHT11PIN 2<span class="comment">//定义传感器连接引脚。此处的PIN2在NodeMcu8266开发板上对应的引脚是D4</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I2C_ADDR = <span class="number">0x3c</span>;              <span class="comment">// oled屏幕的I2c地址</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDA_PIN 4                       <span class="comment">// SDA引脚，默认gpio4(D2)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCL_PIN 5                       <span class="comment">// SCL引脚，默认gpio5(D1)</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BMP_SCK 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BMP_MISO 14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BMP_MOSI 13 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BMP_CS 12                      <span class="comment">//气压传感器引脚定义</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">SSD1306Wire <span class="title">oled</span><span class="params">(I2C_ADDR, SDA_PIN, SCL_PIN)</span></span>;</span><br><span class="line"><span class="function">Adafruit_BMP280 <span class="title">bmp</span><span class="params">(BMP_CS, BMP_MOSI, BMP_MISO,  BMP_SCK)</span></span>;</span><br><span class="line">String number[]=&#123;<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> text[][<span class="number">32</span>]=&#123;</span><br><span class="line"><span class="number">0x10</span>,<span class="number">0x04</span>,<span class="number">0x60</span>,<span class="number">0x04</span>,<span class="number">0x02</span>,<span class="number">0x7E</span>,<span class="number">0x8C</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x7E</span>,<span class="number">0xFE</span>,<span class="number">0x42</span>,<span class="number">0x92</span>,<span class="number">0x42</span>,<span class="number">0x92</span>,<span class="number">0x7E</span>,<span class="number">0x92</span>,<span class="number">0x42</span>,<span class="number">0x92</span>,<span class="number">0x7E</span>,<span class="number">0x92</span>,<span class="number">0x42</span>,<span class="number">0xFE</span>,<span class="number">0x42</span>,<span class="number">0x00</span>,<span class="number">0x7E</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;温&quot;,0*/</span></span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x30</span>,<span class="number">0xFC</span>,<span class="number">0x8F</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x24</span>,<span class="number">0x84</span>,<span class="number">0x24</span>,<span class="number">0x4C</span>,<span class="number">0xFC</span>,<span class="number">0x55</span>,<span class="number">0x25</span>,<span class="number">0x25</span>,<span class="number">0x26</span>,<span class="number">0x25</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0xFC</span>,<span class="number">0x55</span>,<span class="number">0x24</span>,<span class="number">0x4C</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x04</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;度&quot;,1*/</span></span><br><span class="line"><span class="number">0x10</span>,<span class="number">0x04</span>,<span class="number">0x60</span>,<span class="number">0x04</span>,<span class="number">0x02</span>,<span class="number">0x7E</span>,<span class="number">0x8C</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0xFE</span>,<span class="number">0x48</span>,<span class="number">0x92</span>,<span class="number">0x50</span>,<span class="number">0x92</span>,<span class="number">0x7F</span>,<span class="number">0x92</span>,<span class="number">0x40</span>,<span class="number">0x92</span>,<span class="number">0x40</span>,<span class="number">0x92</span>,<span class="number">0x7F</span>,<span class="number">0x92</span>,<span class="number">0x50</span>,<span class="number">0xFE</span>,<span class="number">0x48</span>,<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;湿&quot;,2*/</span></span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x30</span>,<span class="number">0xFC</span>,<span class="number">0x8F</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x24</span>,<span class="number">0x84</span>,<span class="number">0x24</span>,<span class="number">0x4C</span>,<span class="number">0xFC</span>,<span class="number">0x55</span>,<span class="number">0x25</span>,<span class="number">0x25</span>,<span class="number">0x26</span>,<span class="number">0x25</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0xFC</span>,<span class="number">0x55</span>,<span class="number">0x24</span>,<span class="number">0x4C</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x24</span>,<span class="number">0x80</span>,<span class="number">0x04</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;度&quot;,3*/</span></span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0xFE</span>,<span class="number">0x1F</span>,<span class="number">0x02</span>,<span class="number">0x00</span>,<span class="number">0x12</span>,<span class="number">0x20</span>,<span class="number">0x22</span>,<span class="number">0x10</span>,<span class="number">0xC2</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x03</span>,<span class="number">0xC2</span>,<span class="number">0x0C</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x02</span>,<span class="number">0x00</span>,<span class="number">0xFE</span>,<span class="number">0x0F</span>,<span class="number">0x00</span>,<span class="number">0x30</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0xF8</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;风&quot;,4*/</span></span><br><span class="line"><span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x20</span>,<span class="number">0xCC</span>,<span class="number">0x1F</span>,<span class="number">0x00</span>,<span class="number">0x20</span>,<span class="number">0x04</span>,<span class="number">0x48</span>,<span class="number">0xF4</span>,<span class="number">0x44</span>,<span class="number">0x94</span>,<span class="number">0x42</span>,<span class="number">0x94</span>,<span class="number">0x41</span>,<span class="number">0xFF</span>,<span class="number">0x5F</span>,<span class="number">0x94</span>,<span class="number">0x41</span>,<span class="number">0x94</span>,<span class="number">0x42</span>,<span class="number">0xF4</span>,<span class="number">0x44</span>,<span class="number">0x04</span>,<span class="number">0x48</span>,<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;速&quot;,5*/</span></span><br><span class="line"><span class="number">0x20</span>,<span class="number">0x00</span>,<span class="number">0x10</span>,<span class="number">0x00</span>,<span class="number">0x4C</span>,<span class="number">0x00</span>,<span class="number">0x47</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0xD4</span>,<span class="number">0x0F</span>,<span class="number">0x04</span>,<span class="number">0x30</span>,<span class="number">0x04</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0xF0</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;气&quot;,6*/</span></span><br><span class="line"><span class="number">0x00</span>,<span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0xFE</span>,<span class="number">0x1F</span>,<span class="number">0x02</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0xFA</span>,<span class="number">0x7F</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x82</span>,<span class="number">0x44</span>,<span class="number">0x82</span>,<span class="number">0x58</span>,<span class="number">0x82</span>,<span class="number">0x40</span>,<span class="number">0x02</span>,<span class="number">0x40</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="comment">/*&quot;压&quot;,7*/</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> wind=<span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">float</span> wind_value=<span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);<span class="comment">//设置波特率为115200</span></span><br><span class="line"></span><br><span class="line">  Blinker.<span class="built_in">begin</span>(auth, ssid, pswd);  </span><br><span class="line"></span><br><span class="line">  oled.<span class="built_in">init</span>();                        <span class="comment">//初始化</span></span><br><span class="line">  oled.<span class="built_in">flipScreenVertically</span>();        <span class="comment">// 设置屏幕翻转</span></span><br><span class="line">  oled.<span class="built_in">setContrast</span>(<span class="number">255</span>);              <span class="comment">// 设置屏幕亮度</span></span><br><span class="line">  <span class="built_in">drawRect</span>();                         <span class="comment">// 测试屏幕显示</span></span><br><span class="line">  oled.<span class="built_in">clear</span>(); oled.<span class="built_in">display</span>();       <span class="comment">// 清除屏幕</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************###主函数###********************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Blinker.<span class="built_in">run</span>();</span><br><span class="line">  bmp.<span class="built_in">begin</span>();</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  DHT11.<span class="built_in">read</span>(DHT11PIN); <span class="comment">//更新传感器所有信息</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">500</span>);<span class="comment">//每0.5秒打印一次</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> sensorValue = <span class="built_in">analogRead</span>(A0);</span><br><span class="line">  <span class="keyword">float</span> wind = sensorValue * (<span class="number">5.0</span> / <span class="number">1024.0</span>); </span><br><span class="line">  wind_value=<span class="number">100</span>*wind<span class="number">-4.39</span>;</span><br><span class="line">  </span><br><span class="line">  oled.<span class="built_in">setFont</span>(ArialMT_Plain_16);     <span class="comment">// 设置字体</span></span><br><span class="line">  oled.<span class="built_in">clear</span>();</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">0</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">1</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">18</span> + <span class="number">16</span>*<span class="number">3</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">2</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">18</span> + <span class="number">16</span>*<span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">3</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">0</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">4</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">1</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">5</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">0</span>, <span class="number">19</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">6</span>]);</span><br><span class="line">  oled.<span class="built_in">drawFastImage</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">1</span>, <span class="number">19</span>*<span class="number">2</span>, <span class="number">16</span>, <span class="number">16</span>, text[<span class="number">7</span>]);</span><br><span class="line">  oled.<span class="built_in">drawString</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">2</span>, <span class="number">0</span>, <span class="string">&quot;:&quot;</span>+number[DHT11.temperature/<span class="number">10</span>]+number[DHT11.temperature%<span class="number">10</span>]);</span><br><span class="line">  oled.<span class="built_in">drawString</span>(<span class="number">18</span> + <span class="number">16</span>*<span class="number">5</span>, <span class="number">0</span>, <span class="string">&quot;:&quot;</span>+number[DHT11.humidity/<span class="number">10</span>]+number[DHT11.humidity%<span class="number">10</span>]);</span><br><span class="line">  oled.<span class="built_in">drawString</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">2</span>, <span class="number">19</span>, <span class="string">&quot;:&quot;</span>+number[(<span class="keyword">int</span>)wind_value/<span class="number">100</span>]+number[(<span class="keyword">int</span>)wind_value/<span class="number">10</span>%<span class="number">10</span>]+number[(<span class="keyword">int</span>)wind_value%<span class="number">10</span>]+<span class="string">&quot;.&quot;</span>+number[((<span class="keyword">int</span>)(wind_value*<span class="number">100</span>))/<span class="number">10</span>%<span class="number">10</span>]+number[((<span class="keyword">int</span>)(wind_value*<span class="number">100</span>))%<span class="number">10</span>]+<span class="string">&quot;km/h&quot;</span>);</span><br><span class="line">  <span class="built_in">pressuCheck</span>();</span><br><span class="line">  oled.<span class="built_in">display</span>(); </span><br><span class="line"> </span><br><span class="line">  Tem.<span class="built_in">print</span>(DHT11.temperature); </span><br><span class="line">  Hum.<span class="built_in">print</span>(DHT11.humidity);  </span><br><span class="line">  Wind.<span class="built_in">print</span>(wind_value);           </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawRect</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int16_t</span> i=<span class="number">0</span>; i&lt;oled.<span class="built_in">getHeight</span>()/<span class="number">2</span>; i+=<span class="number">2</span>) &#123;</span><br><span class="line">    oled.<span class="built_in">drawRect</span>(i, i, oled.<span class="built_in">getWidth</span>()<span class="number">-2</span>*i, oled.<span class="built_in">getHeight</span>()<span class="number">-2</span>*i);</span><br><span class="line">    oled.<span class="built_in">display</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pressuCheck</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">float</span> Pressure=<span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">int</span> Pressure1,Pressure2,Pressure3,Pressure4,Pressure5,Pressure6,Pressure7,Pressure8;</span><br><span class="line">Pressure=bmp.<span class="built_in">readPressure</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//由于气压的位数比较多，因此单独储存便于分类</span></span><br><span class="line">  Pressure1=(<span class="keyword">int</span>)Pressure/<span class="number">100000</span>;</span><br><span class="line">  Pressure2=(<span class="keyword">int</span>)Pressure/<span class="number">10000</span>%<span class="number">10</span>;</span><br><span class="line">  Pressure3=(<span class="keyword">int</span>)Pressure/<span class="number">1000</span>%<span class="number">10</span>;</span><br><span class="line">  Pressure4=(<span class="keyword">int</span>)Pressure/<span class="number">100</span>%<span class="number">10</span>;</span><br><span class="line">  Pressure5=(<span class="keyword">int</span>)Pressure/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">  Pressure6=(<span class="keyword">int</span>)Pressure%<span class="number">10</span>;</span><br><span class="line">  Pressure7=((<span class="keyword">int</span>)(Pressure*<span class="number">100</span>))/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">  Pressure8=((<span class="keyword">int</span>)(Pressure*<span class="number">100</span>))%<span class="number">10</span>;</span><br><span class="line">  oled.<span class="built_in">drawString</span>(<span class="number">4</span> + <span class="number">16</span>*<span class="number">2</span>, <span class="number">19</span>*<span class="number">2</span>, <span class="string">&quot;:&quot;</span>+number[Pressure1]+number[Pressure2]+number[Pressure3]+number[Pressure4]+number[Pressure5]+number[Pressure6]+<span class="string">&quot;.&quot;</span>+number[Pressure7]+number[Pressure8]+<span class="string">&quot;P&quot;</span>);</span><br><span class="line">    </span><br><span class="line">  Air.<span class="built_in">print</span>(Pressure);     </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>注意事项：</strong></p><ul><li>代码中的中文汉字用到了一个叫  <img src="http://tva1.sinaimg.cn/large/008ruEzYly1gynsgushuej300l00lgld.jpg" alt="image.png"><code>PCtoLCD2002</code>  的软件,这个软件可以很方便的将汉字转化成对应的字形码来输出，这里用的是16*16的字宽字长。</li><li>在文章末尾的名叫<code>pressuCheck()</code>的子函数，之所以把这段单独写出来而不是写在<code>loop</code>函数里面去处理，不是因为笔者的代码习惯，而是必须这样不可。因为ESP8266芯片的内存有限，笔者一开始非常畅快的在<code>loop</code>函数中大写特写，结果虽然编译没有问题，但是上传到单片机上的时候，设备一直死机重启，害的笔者一开始还以为焊接的时候动到单片机的Rst引脚了，最后才反应过来是内存溢出的问题，把全局变量改为了局部变量之后，内存溢出问题得以解决。  </li><li>老生常谈，NodeMCU只支持3.3V电压，过高的电压可能会损坏芯片。</li><li>连接手机的app使用的是电灯科技的接口，一方面租用服务器很贵，对于这种学习性质的设计来说有些划不来，另一方面则是考虑到开发时间的问题，如果转向Android开发则会使得开发的重心偏移，关于Android我有计划在以后的博客中编写</li><li>最后，esp8266这块芯片真的很好用，使用Arduino的库真的省去了大量的重复造轮子的时间，如果转而用51<br>系列单片机开发代码量起码是这个的五倍。不过如果是用来学习嵌入式，我想51还是更好的选择，因为他更能让人深刻的理解嵌入开发。</li></ul><hr><h2 id="五、实物图"><a href="#五、实物图" class="headerlink" title="五、实物图"></a>五、实物图</h2><p><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gynt3cnjfrj31hc0tu79g.jpg" alt="实物图1.jpg"><br><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gynt3cnpaij31hc0tujxc.jpg" alt="实物图2.jpg"><br><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gynt3colxaj31hc0tu0z5.jpg" alt="实物图3.jpg"></p><h2 id="六、结束"><a href="#六、结束" class="headerlink" title="六、结束"></a>六、结束</h2><p>这次的设计总的来说是数据的采集和发送，逻辑上并不困难，学习各个传感器的引脚定义可能花费了一点时间，但也并不属于很复杂的项目，今后有机会想做一些更有挑战性的东西。</p>]]></content>
    
    
    <summary type="html">经过一段时间对esp8266的了解和学习，尝试着做了一个esp8266的项目，是一个农业气象监测站，可以实时采集观测地的温湿度风速压强并显示在oled屏幕上，然后通过网络将数据传回用户手机APP，做到实时监测。</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="嵌入式" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="嵌入式开发" scheme="http://yoursite.com/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Esp8266与51单片机的Ap模式配置教程</title>
    <link href="http://yoursite.com/2022/01/18/AP_template/"/>
    <id>http://yoursite.com/2022/01/18/AP_template/</id>
    <published>2022-01-18T03:59:00.000Z</published>
    <updated>2023-11-01T17:53:32.151Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、什么是Esp8266的AP模式"><a href="#一、什么是Esp8266的AP模式" class="headerlink" title="一、什么是Esp8266的AP模式"></a>一、什么是Esp8266的AP模式</h2><p>ESP8266支持3种模式：<strong>Station模式、AP模式和Station+AP混合模式</strong>。关于这三种模式的区别可以类比我们的手机，当手机连接无线网时，此时手机为Station模式，当手机打开移动热点时，此时手机为AP模式。简单的说就是Station模式就是作为终端，AP模式就是作为路由器。而Station+AP混合模式，就和路由器的无线桥接功能是一样的，既可以连接别的无线网，同时也可以自己作为路由器。<br>本文是使用AP模式进行与手机的连接，从而控制单片机。  </p><hr><h2 id="二、ESP8266的准备工作"><a href="#二、ESP8266的准备工作" class="headerlink" title="二、ESP8266的准备工作"></a>二、ESP8266的准备工作</h2><p>在使用ESP8266之前需要进行一些配置，因为esp8266是一款功能丰富的芯片，通常我更喜欢直接针对它进行开发，在我看来，单单作为无线传输模块来使用未免有些“大材小用”之感，作为Ap模式来工作与蓝牙模块也并无大的不同，如果读者对esp8266的其他的模式感兴趣，比如mqtt协议之类的，可以查看我之前的帖子，那应该是更成熟的物联网方案。<br>闲话少叙，首先我们要将esp8266与电脑连接然后随便下载一个串口调试助手，对芯片进行一些配置。esp8266与电脑之间的通过usb-ttl方式的连线网上有很多，这里就不多做赘述，我个人推荐淘宝买个esp8266的专用下载器，会省事很多，不要把时间浪费在与芯片下载斗智斗勇上，应该多关注开发。<br>我使用的串口调试软件是<img src="https://pic.imgdb.cn/item/6267752b239250f7c58a6031.jpg" alt="XCOM"><code>XCOM</code>。下面贴调试命令：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">AT+CWMODE=2    //这个命令是为了配置esp8266工作模式为AP模式</span><br><span class="line">返回值：OK</span><br><span class="line"></span><br><span class="line">AT+CWSAP=&quot;ESP8266&quot;,&quot;123456789&quot;,11,0  //这条命令是用来配置芯片热点的名称和密码以及加密方式</span><br><span class="line">返回值：OK</span><br><span class="line"></span><br><span class="line">AT+RST // 重启模块</span><br><span class="line"></span><br><span class="line">AT+UART=9600,8,1,0,0 //这条命令主要是设置波特率9600-波特率 8-8bit数据位 1-1bit停止位 0-none校验位 0-不使能流控。因为芯片波特率需要与单片机一致才能进行通信。</span><br><span class="line">返回值：OK</span><br><span class="line"></span><br><span class="line">AT+CIPMUX=1 //开启多连接，这句每次重启芯片都需要配置会写进代码里面</span><br><span class="line">返回值：OK</span><br><span class="line"></span><br><span class="line">AT+CIPSERVER=1,8080 //建立服务器，端口号8080，这句每次重启芯片都需要配置会写进代码里面</span><br><span class="line">返回值：OK</span><br></pre></td></tr></table></figure><p>通过串口助手依次输入以上命令之后，手机应该可以找到esp8266生成的一个wifi了，进行连接之后打开手机上的TCP网络调试助手，这个app网上有很多可以随便下一个，或者自己用androidstudio开发也并不会花很多时间，更重要的是自己开发你可以隐藏很多输入和命令，直接做成按钮事件，作为设计来说更为完善。<br>手机打开调试调试助手后，输入IP地址：192.168.4.1（通常默认为这个地址，可通过AT指令自查），端口号：8080（设置的数值）连接成功后随便发送一些消息给esp8266，比如hello，那么串口助手就会收到类似 +IPD,0,3:hello 这样的信息，这样我们芯片前期的配置工作就完成了。   </p><hr><h2 id="三、单片机方面"><a href="#三、单片机方面" class="headerlink" title="三、单片机方面"></a>三、单片机方面</h2><p>首先将单片机与ESP8266连接起来，连接方式也很简单和USB-TTL连接基本一致：<br>| 51单片机   | 3.3V | GND | TXD | RXD | 3.3V      |<br>|———|——|—–|—–|—–|———–|<br>| ESP8266 | VCC  | GND | RXD | TXD | EN(ch_pd) |</p><p>因为51单片机引脚电压为5V，esp8266工作电压确实3.3v因此直接连接可能会导致芯片寿命缩短甚至损坏，因此建议接一个电平转换模块来进行电平转换，再不济也需接个分压电阻。<br>模块连接好之后就可以向单片机中烧写程序了，代码贴在下面，建议自己敲一遍而不是直接复制粘贴，可以加深你对代码的理解：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uchar unsigned char    <span class="comment">//对数据类型进行声明定义</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uint unsigned int </span></span><br><span class="line"></span><br><span class="line">sbit LED1 = P2^<span class="number">0</span>;</span><br><span class="line">sbit LED2 = P2^<span class="number">1</span>;</span><br><span class="line">sbit LED3 = P2^<span class="number">2</span>;</span><br><span class="line">sbit LED4 = P2^<span class="number">3</span>;   <span class="comment">//用于调试的LED灯</span></span><br><span class="line">sbit LED5 = P2^<span class="number">4</span>;</span><br><span class="line">sbit LED6 = P2^<span class="number">5</span>;</span><br><span class="line">sbit LED7 = P2^<span class="number">6</span>;</span><br><span class="line">sbit LED8 = P2^<span class="number">7</span>;   <span class="comment">//手机可以控制的LED灯</span></span><br><span class="line"></span><br><span class="line">uchar TX_Flag = <span class="number">1</span>;   <span class="comment">//发送状态标志位，1允许发送，0发送结束</span></span><br><span class="line">uchar RX_Flag = <span class="number">1</span>;   <span class="comment">//接收状态标志位，1允许接收，0接收结束</span></span><br><span class="line">uchar num=<span class="number">0</span>;   <span class="comment">//接收超时判断</span></span><br><span class="line">uchar Recivedata;   <span class="comment">//存储接收到的一个字节数据</span></span><br><span class="line"></span><br><span class="line">uchar Recive_table[<span class="number">15</span>];</span><br><span class="line">uint i=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ms_delay</span><span class="params">(uint n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">uint j,m;</span><br><span class="line"><span class="keyword">for</span>( m =n; m&gt;<span class="number">0</span>; m--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>; j&gt;<span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">us_delay</span><span class="params">(uchar n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(n--);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void Usart_init()</span></span><br><span class="line"><span class="comment">功 能: 单片机初始化</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Usart_init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">SCON = <span class="number">0x50</span>;<span class="comment">//设置串行口工作在方式一，且启动串行口接收(REN=1)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TMOD = <span class="number">0x20</span>;<span class="comment">//定时器1工作在方式2八位自动重装模式</span></span><br><span class="line">TH1 = <span class="number">0xfd</span>;</span><br><span class="line">TL1 = <span class="number">0xfd</span>;</span><br><span class="line">TR1 = <span class="number">1</span>;<span class="comment">//开启定时器1</span></span><br><span class="line"></span><br><span class="line">PCON = <span class="number">0x00</span>;<span class="comment">//波特率不加倍</span></span><br><span class="line">SM0 = <span class="number">0</span>;<span class="comment">//串口工作方式</span></span><br><span class="line">SM1 = <span class="number">1</span>;</span><br><span class="line">REN = <span class="number">1</span>;<span class="comment">//串口接收允许</span></span><br><span class="line">EA = <span class="number">1</span>;<span class="comment">//打开全局中断</span></span><br><span class="line">ES = <span class="number">1</span>;<span class="comment">//允许串口中断</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void Sent_AT(uchar *At_Comd)</span></span><br><span class="line"><span class="comment">功 能: AT指令发送</span></span><br><span class="line"><span class="comment">参 数: 字符串指针</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Sent_AT</span><span class="params">(uchar *At_Comd)</span>  <span class="comment">//定义字符串指针指向AT指令</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ES = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(*At_Comd != <span class="string">&#x27;\0&#x27;</span>)   <span class="comment">//字符串结束标志</span></span><br><span class="line">&#123;</span><br><span class="line">SBUF = *At_Comd;  <span class="comment">//写入1个字节数据</span></span><br><span class="line"><span class="keyword">while</span>(!TI);  <span class="comment">//等待该字节数据发送完成</span></span><br><span class="line">TI = <span class="number">0</span>;  <span class="comment">//发送标志位清零</span></span><br><span class="line"><span class="built_in">us_delay</span>(<span class="number">5</span>);</span><br><span class="line">At_Comd++;  <span class="comment">//指向下一个字节</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void WIFI_Init(void)</span></span><br><span class="line"><span class="comment">功 能: wifi初始化</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WIFI_Init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">        ES = <span class="number">0</span>;                                <span class="comment">//关闭串口中断，防止收发过程被打扰</span></span><br><span class="line"><span class="keyword">while</span>(TX_Flag == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">Sent_AT</span>(<span class="string">&quot;AT+CIPMUX=1\r\n&quot;</span>);        <span class="comment">//调用发送函数</span></span><br><span class="line">  LED1=<span class="number">0</span>;   <span class="comment">//表示发送正常</span></span><br><span class="line"><span class="keyword">while</span>(RX_Flag == <span class="number">1</span>)            <span class="comment">//检测模块是否返回OK</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(RI)</span><br><span class="line">&#123;</span><br><span class="line">RI = <span class="number">0</span>;</span><br><span class="line">Recivedata = SBUF;   <span class="comment">//保存当前接收到的1个字</span></span><br><span class="line"><span class="keyword">if</span>(Recivedata == <span class="string">&#x27;K&#x27;</span>)  <span class="comment">//回传“OK”中的K表示配置完成</span></span><br><span class="line">&#123;</span><br><span class="line">TX_Flag = <span class="number">0</span>;   <span class="comment">//标志位清零，跳出收发循环</span></span><br><span class="line">RX_Flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">num++;   <span class="comment">//累加</span></span><br><span class="line"><span class="keyword">if</span>(num == <span class="number">1000</span>)   <span class="comment">//未收到OK或接收超时</span></span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line">RX_Flag = <span class="number">0</span>;   <span class="comment">//跳出接收查询，再次发送</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">TX_Flag = <span class="number">1</span>;   <span class="comment">//跳出循环，表示配置成功</span></span><br><span class="line">RX_Flag = <span class="number">1</span>;</span><br><span class="line">num = <span class="number">0</span>;   <span class="comment">//标志位还原</span></span><br><span class="line">        LED2 = <span class="number">0</span>;   <span class="comment">//可通过LED灯表示配置完成</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(TX_Flag == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">Sent_AT</span>(<span class="string">&quot;AT+CIPSERVER=1,8080\r\n&quot;</span>);</span><br><span class="line">    LED3=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(RX_Flag == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(RI)</span><br><span class="line">&#123;</span><br><span class="line">RI = <span class="number">0</span>;</span><br><span class="line">Recivedata = SBUF;</span><br><span class="line"><span class="keyword">if</span>(Recivedata == <span class="string">&#x27;K&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">TX_Flag= <span class="number">0</span>;</span><br><span class="line">RX_Flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">num++;</span><br><span class="line"><span class="keyword">if</span>(num == <span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line">RX_Flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">TX_Flag= <span class="number">1</span>;</span><br><span class="line">RX_Flag = <span class="number">1</span>;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line">LED4 = <span class="number">0</span>;</span><br><span class="line">ES=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**********************主函数************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">Usart_init</span>();</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">5000</span>);</span><br><span class="line"><span class="built_in">WIFI_Init</span>();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>);<span class="comment">///循环等待中断</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void Uart_Interrupt() interrupt 4</span></span><br><span class="line"><span class="comment">功 能: 串口中断函数,将收到的字符存到Recive_table[]数组中</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Uart_Interrupt</span><span class="params">()</span> interrupt 4                <span class="comment">//中断服务程序接收并处理数据</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">RI=<span class="number">0</span>;   <span class="comment">//接收标志位清零</span></span><br><span class="line">Recive_table[i] = SBUF;   <span class="comment">//将数据存入数组</span></span><br><span class="line"><span class="keyword">if</span>(Recive_table[<span class="number">0</span>]==<span class="string">&#x27;+&#x27;</span>)   <span class="comment">//初步检测有用信息</span></span><br><span class="line">&#123;i++;&#125;      </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;i=<span class="number">0</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(i&gt;=<span class="number">10</span>)     <span class="comment">//一组数据接收完成</span></span><br><span class="line">&#123;</span><br><span class="line">LED5 = <span class="number">0</span>;   <span class="comment">//LED显示接收完成</span></span><br><span class="line"><span class="keyword">if</span>((Recive_table[<span class="number">0</span>]==<span class="string">&#x27;+&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">1</span>]==<span class="string">&#x27;I&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">2</span>]==<span class="string">&#x27;P&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">3</span>]==<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line">&#123; <span class="comment">//检测有效信息</span></span><br><span class="line"><span class="keyword">if</span>((Recive_table[<span class="number">9</span>]==<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">LED8=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>((Recive_table[<span class="number">9</span>]==<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">LED8=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">LED7=<span class="number">0</span>; <span class="comment">//发送信息不符合</span></span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> LED6=<span class="number">0</span>; <span class="comment">//未接收到正确格式数据</span></span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> TI = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一个常识性的问题——烧写程序的时候TXD和RXD引脚需置空否则会烧写失败，程序烧进单片机之后，按一下板子的复位按钮，如果看到ESP模块上面蓝色小灯闪了，证明开发板跟ESP-01模块通信正常。然后用手机连上WIFI，打开TCP助手，建立一个新连接，IP地址192.168.4.1，端口8080，如果发送一个1，开发板上的小灯亮了，发送0，灯灭了（可能根据led共阴接法和共阳接法不同而有所改变），说明一切正常，如果不是这样的话，那就需要自己找找原因了，比如led口的接口定义与代码中是否一致。</p><hr><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>我用开发板进行的一个简单的程序验证和测试，只是一个模板代码，具体需要实现什么功能就请自己修改吧。</p>]]></content>
    
    
    <summary type="html">这是一个学弟问esp8266与51单片机连接然后通过手机来对单片机进行操作的配置问题，感觉发消息不方便贴代码和讲解，就干脆小写一篇教程了。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="模板记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="记录" scheme="http://yoursite.com/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>Esp8266与51单片机的Ap模式发送数据模板</title>
    <link href="http://yoursite.com/2022/01/16/AP_sendMessage/"/>
    <id>http://yoursite.com/2022/01/16/AP_sendMessage/</id>
    <published>2022-01-16T09:58:04.000Z</published>
    <updated>2023-11-01T17:54:00.423Z</updated>
    
    <content type="html"><![CDATA[<h2 id="准备与连接"><a href="#准备与连接" class="headerlink" title="准备与连接"></a>准备与连接</h2><p>51单片机与esp8266芯片的配置与连线请参考上一篇博客进行配置，配置完成并连线即可。</p><hr><h2 id="发送代码"><a href="#发送代码" class="headerlink" title="发送代码"></a>发送代码</h2><p>将以下代码烧录进单片机中</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;intrins.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> u16;  <span class="comment">//对数据类型进行声明定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> u8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MotorData P0 </span></span><br><span class="line">sbit P20_LED=P2^<span class="number">0</span>;<span class="comment">//led灯</span></span><br><span class="line">sbit LED1=P2^<span class="number">1</span>;<span class="comment">//led1</span></span><br><span class="line">sbit LED2=P2^<span class="number">2</span>;<span class="comment">//led2</span></span><br><span class="line">sbit LED3=P2^<span class="number">3</span>;<span class="comment">//led3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> rec_dat[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;         <span class="comment">//存放要发送的数据</span></span><br><span class="line"><span class="keyword">char</span> Recive_table[<span class="number">20</span>]=<span class="string">&quot;&quot;</span>;  <span class="comment">//接收缓冲,最大20个字节</span></span><br><span class="line"><span class="keyword">char</span> Recive_state = <span class="number">0</span>;   <span class="comment">//接收完成标志</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WIFI_Init</span><span class="params">(<span class="keyword">void</span>)</span></span>;    <span class="comment">//wifi初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sending</span><span class="params">(<span class="keyword">void</span>)</span></span>;   <span class="comment">//向手机发送温湿度数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Uart_Init</span><span class="params">(<span class="keyword">void</span>)</span></span>;    <span class="comment">//串口初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ms_delay</span><span class="params">(<span class="keyword">int</span> t)</span></span>;    <span class="comment">//延时</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LED</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">u8 flag;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Uart_Init</span>();<span class="comment">//串口初始化，波特率为9600</span></span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">WIFI_Init</span>(); <span class="comment">//wifi初始化</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**********************主循环************************/</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123; </span><br><span class="line">  <span class="comment">//ms_delay(1000);</span></span><br><span class="line"><span class="keyword">if</span>(Recive_state == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">ES=<span class="number">0</span>;  <span class="comment">//清空接收标志位 </span></span><br><span class="line"><span class="keyword">if</span>((Recive_table[<span class="number">0</span>]==<span class="string">&#x27;+&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">1</span>]==<span class="string">&#x27;I&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">2</span>]==<span class="string">&#x27;P&#x27;</span>))<span class="comment">//接收到的字符串形式为+IPD,x,x:y</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>((Recive_table[<span class="number">3</span>]==<span class="string">&#x27;D&#x27;</span>)&amp;&amp;(Recive_table[<span class="number">6</span>]==<span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">if</span>(Recive_table[<span class="number">9</span>]==<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">P20_LED = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>);</span><br><span class="line">P20_LED = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">sending</span>(); <span class="comment">//向手机发送数据</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(Recive_table[<span class="number">9</span>]==<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">P20_LED = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line">P20_LED = <span class="number">0</span>;</span><br><span class="line">flag=<span class="number">0</span>; <span class="comment">//自动</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span>(Recive_table,<span class="string">&#x27;\0&#x27;</span>,<span class="number">20</span>);</span><br><span class="line">Recive_state = <span class="number">0</span>;</span><br><span class="line">ES=<span class="number">1</span>;  <span class="comment">//打开接收标志位</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void Uart_Interrupt() interrupt 4</span></span><br><span class="line"><span class="comment">功 能: 串口中断函数,将收到的字符存到Recive_table[]数组中</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Uart_Interrupt</span><span class="params">()</span> interrupt 4         </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> i=<span class="number">0</span>;  <span class="comment">//因为是一位一位接收，所以用static</span></span><br><span class="line"><span class="keyword">if</span>(RI==<span class="number">1</span>)    </span><br><span class="line">&#123;  </span><br><span class="line">ES = <span class="number">0</span>;</span><br><span class="line">RI=<span class="number">0</span>;         </span><br><span class="line">Recive_table[i]=SBUF;        </span><br><span class="line">i++; </span><br><span class="line"><span class="keyword">if</span>((Recive_table[i<span class="number">-1</span>] == <span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line">&#123; </span><br><span class="line">Recive_table[i]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">i=<span class="number">0</span>; </span><br><span class="line">Recive_state = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">ES = <span class="number">1</span>;      </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">TI = <span class="number">0</span>;     </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void Uart_Init(void)</span></span><br><span class="line"><span class="comment">功 能: 串口初始化，波特率为9600</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Uart_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">TMOD=<span class="number">0x20</span>;</span><br><span class="line">TH1=<span class="number">0xfD</span>;</span><br><span class="line">TL1=<span class="number">0xfD</span>;</span><br><span class="line">TR1=<span class="number">1</span>;</span><br><span class="line">REN=<span class="number">1</span>;</span><br><span class="line">SM0=<span class="number">0</span>;</span><br><span class="line">SM1=<span class="number">1</span>;</span><br><span class="line">EA=<span class="number">1</span>;</span><br><span class="line">ES=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void ms_delay(int t)</span></span><br><span class="line"><span class="comment">功 能: 毫秒级延时</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ms_delay</span><span class="params">(<span class="keyword">int</span> t)</span> </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line"><span class="keyword">int</span> i,j; </span><br><span class="line"><span class="keyword">for</span>(i=t;i&gt;<span class="number">0</span>;i--)   </span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--); </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void LED(void)</span></span><br><span class="line"><span class="comment">功 能: 发送完命令后显示用的函数</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LED</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">P2 = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">100</span>);</span><br><span class="line">P2 = <span class="number">0xff</span>;</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">函 数: void WIFI_Init(void)</span></span><br><span class="line"><span class="comment">功 能: wifi初始化</span></span><br><span class="line"><span class="comment">参 数: 无</span></span><br><span class="line"><span class="comment">返回值: 无</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WIFI_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ES = <span class="number">0</span>;</span><br><span class="line">TI = <span class="number">1</span>; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+RST\r\n&quot;</span>);</span><br><span class="line"><span class="built_in">LED</span>();</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+CWMODE=3\r\n&quot;</span>);</span><br><span class="line"><span class="built_in">LED</span>();</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+CIPMUX=1\r\n&quot;</span>);</span><br><span class="line"><span class="built_in">LED</span>(); </span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+CIPSERVER=1,8080\r\n&quot;</span>);        </span><br><span class="line"><span class="built_in">LED</span>();</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;AT+CIOBAUD=9600\r\n&quot;</span>);   <span class="comment">// 设置与单片机一致的波特率     </span></span><br><span class="line"><span class="built_in">LED</span>();</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">while</span>(!TI);</span><br><span class="line">TI = <span class="number">0</span>;</span><br><span class="line">ES = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向手机发送数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sending</span><span class="params">(<span class="keyword">void</span>)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ES = <span class="number">0</span>;</span><br><span class="line">TI = <span class="number">1</span>; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+CIPSTART=0,\&quot;TCP\&quot;,\&quot;192.168.4.2\&quot;,8080\r\n&quot;</span>);</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AT+CIPSEND=0,11\r\n&quot;</span>);</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Humi:%d.%d \r\n&quot;</span>,rec_dat[<span class="number">1</span>],rec_dat[<span class="number">3</span>]);</span><br><span class="line"><span class="built_in">ms_delay</span>(<span class="number">1000</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(!TI);</span><br><span class="line">TI = <span class="number">0</span>;</span><br><span class="line">ES = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong><code>rec_dat[i]</code>中保存的是需要发送的数据。</strong>  </p><hr><h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>用手机连上WIFI，打开TCP助手，建立一个新连接，IP地址192.168.4.1，端口8080，如果发送一个1，TCP助手软件接收到一个发送过来设定的数值，那么连接建立成功，发送数据成立。</p>]]></content>
    
    
    <summary type="html">之前写了一篇博客用来描述esp8266与51单片机如何进行连线和一些芯片的配置以及代码模板，但是并没有涉及到发送数据，这篇教程就用来放一篇51系列单片机透过esp8266向手机发送消息的模板。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="模板记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%A8%A1%E6%9D%BF%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="记录" scheme="http://yoursite.com/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>基于Arduino的智能避障小车的设计</title>
    <link href="http://yoursite.com/2022/01/14/BiZhangChe/"/>
    <id>http://yoursite.com/2022/01/14/BiZhangChe/</id>
    <published>2022-01-13T16:00:09.000Z</published>
    <updated>2023-11-01T17:31:42.817Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、原件清单"><a href="#一、原件清单" class="headerlink" title="一、原件清单"></a>一、原件清单</h2><ul><li>Arduino Uno开发板</li><li>L293D </li><li>轮子 (4x)</li><li>直流电机 (4x) </li><li>伺服电机sg90 </li><li>超声波传感器 </li><li>18650 锂电池 (2x) </li><li>18650 插针式电池盒子</li><li>跳线</li><li>亚克力板</li><li>三脚拨动开关   </li></ul><hr><h2 id="二、硬件连接"><a href="#二、硬件连接" class="headerlink" title="二、硬件连接"></a>二、硬件连接</h2><ol><li><p>L293D直流电机驱动模块与Arduino兼容，模块的0~13、gnd、以及ARef引脚直接连接对应Arduino的引脚，另一侧同样对应连接。  </p></li><li><p>图中标记为L293D的四个H桥，可分别连接四个直流电机。<br><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gycixlm8n3j30ep0gfdog.jpg" alt="L293D">  </p></li><li><p>超声波传感器的Vcc连接L293D的+5v，Gnd连接L293D的Gnd，Trig连A0，Echo连接A1。  </p></li><li><p>伺服电机直接连接L293D板子的伺服电机端口。   </p></li><li><p>两节18650锂电池串联接入L293D的外部供电。  </p></li></ol><h2 id="三、程序代码"><a href="#三、程序代码" class="headerlink" title="三、程序代码"></a>三、程序代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;AFMotor.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;NewPing.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Servo.h&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TRIG_PIN A0 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ECHO_PIN A1 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_DISTANCE 200 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_SPEED 190 <span class="comment">// sets speed of DC  motors</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_SPEED_OFFSET 20</span></span><br><span class="line"></span><br><span class="line"><span class="function">NewPing <span class="title">sonar</span><span class="params">(TRIG_PIN, ECHO_PIN, MAX_DISTANCE)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function">AF_DCMotor <span class="title">motor1</span><span class="params">(<span class="number">1</span>, MOTOR12_1KHZ)</span></span>; </span><br><span class="line"><span class="function">AF_DCMotor <span class="title">motor2</span><span class="params">(<span class="number">2</span>, MOTOR12_1KHZ)</span></span>;</span><br><span class="line"><span class="function">AF_DCMotor <span class="title">motor3</span><span class="params">(<span class="number">3</span>, MOTOR34_1KHZ)</span></span>;</span><br><span class="line"><span class="function">AF_DCMotor <span class="title">motor4</span><span class="params">(<span class="number">4</span>, MOTOR34_1KHZ)</span></span>;</span><br><span class="line">Servo myservo;   </span><br><span class="line"></span><br><span class="line">boolean goesForward=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> distance = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> speedSet = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  myservo.<span class="built_in">attach</span>(<span class="number">10</span>);  </span><br><span class="line">  myservo.<span class="built_in">write</span>(<span class="number">180</span>); </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">2000</span>);</span><br><span class="line">  distance = <span class="built_in">readPing</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  distance = <span class="built_in">readPing</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  distance = <span class="built_in">readPing</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  distance = <span class="built_in">readPing</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="keyword">int</span> distanceR = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">int</span> distanceL =  <span class="number">0</span>;</span><br><span class="line"> <span class="built_in">delay</span>(<span class="number">40</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">if</span>(distance&lt;=<span class="number">15</span>)</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="built_in">moveStop</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  <span class="built_in">moveBackward</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">300</span>);</span><br><span class="line">  <span class="built_in">moveStop</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">  distanceR = <span class="built_in">lookRight</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">  distanceL = <span class="built_in">lookLeft</span>();</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(distanceR&gt;=distanceL)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">turnRight</span>();</span><br><span class="line">    <span class="built_in">moveStop</span>();</span><br><span class="line">  &#125;<span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">turnLeft</span>();</span><br><span class="line">    <span class="built_in">moveStop</span>();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;<span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="built_in">moveForward</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> distance = <span class="built_in">readPing</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lookRight</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    myservo.<span class="built_in">write</span>(<span class="number">50</span>); </span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">    <span class="keyword">int</span> distance = <span class="built_in">readPing</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">    myservo.<span class="built_in">write</span>(<span class="number">115</span>); </span><br><span class="line">    <span class="keyword">return</span> distance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lookLeft</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    myservo.<span class="built_in">write</span>(<span class="number">170</span>); </span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">    <span class="keyword">int</span> distance = <span class="built_in">readPing</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">    myservo.<span class="built_in">write</span>(<span class="number">115</span>); </span><br><span class="line">    <span class="keyword">return</span> distance;</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">readPing</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">70</span>);</span><br><span class="line">  <span class="keyword">int</span> cm = sonar.<span class="built_in">ping_cm</span>();</span><br><span class="line">  <span class="keyword">if</span>(cm==<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    cm = <span class="number">250</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">moveStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  motor1.<span class="built_in">run</span>(RELEASE); </span><br><span class="line">  motor2.<span class="built_in">run</span>(RELEASE);</span><br><span class="line">  motor3.<span class="built_in">run</span>(RELEASE);</span><br><span class="line">  motor4.<span class="built_in">run</span>(RELEASE);</span><br><span class="line">  &#125; </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">moveForward</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(!goesForward)</span><br><span class="line">  &#123;</span><br><span class="line">    goesForward=<span class="literal">true</span>;</span><br><span class="line">    motor1.<span class="built_in">run</span>(FORWARD);      </span><br><span class="line">    motor2.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">    motor3.<span class="built_in">run</span>(FORWARD); </span><br><span class="line">    motor4.<span class="built_in">run</span>(FORWARD);     </span><br><span class="line">   <span class="keyword">for</span> (speedSet = <span class="number">0</span>; speedSet &lt; MAX_SPEED; speedSet +=<span class="number">2</span>) <span class="comment">// slowly bring the speed up to avoid loading down the batteries too quickly</span></span><br><span class="line">   &#123;</span><br><span class="line">    motor1.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor2.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor3.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor4.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">5</span>);</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">moveBackward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    goesForward=<span class="literal">false</span>;</span><br><span class="line">    motor1.<span class="built_in">run</span>(BACKWARD);      </span><br><span class="line">    motor2.<span class="built_in">run</span>(BACKWARD);</span><br><span class="line">    motor3.<span class="built_in">run</span>(BACKWARD);</span><br><span class="line">    motor4.<span class="built_in">run</span>(BACKWARD);  </span><br><span class="line">  <span class="keyword">for</span> (speedSet = <span class="number">0</span>; speedSet &lt; MAX_SPEED; speedSet +=<span class="number">2</span>) <span class="comment">// slowly bring the speed up to avoid loading down the batteries too quickly</span></span><br><span class="line">  &#123;</span><br><span class="line">    motor1.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor2.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor3.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    motor4.<span class="built_in">setSpeed</span>(speedSet);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">5</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turnRight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  motor1.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor2.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor3.<span class="built_in">run</span>(BACKWARD);</span><br><span class="line">  motor4.<span class="built_in">run</span>(BACKWARD);     </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">  motor1.<span class="built_in">run</span>(FORWARD);      </span><br><span class="line">  motor2.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor3.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor4.<span class="built_in">run</span>(FORWARD);      </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turnLeft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  motor1.<span class="built_in">run</span>(BACKWARD);     </span><br><span class="line">  motor2.<span class="built_in">run</span>(BACKWARD);  </span><br><span class="line">  motor3.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor4.<span class="built_in">run</span>(FORWARD);   </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">  motor1.<span class="built_in">run</span>(FORWARD);     </span><br><span class="line">  motor2.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor3.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">  motor4.<span class="built_in">run</span>(FORWARD);</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h2 id="四、注意事项"><a href="#四、注意事项" class="headerlink" title="四、注意事项"></a>四、注意事项</h2><p><strong>1. 使用18650作外部供电时，切记不要连反了线，否则会有烧芯片的风险。</strong><br><strong>2. 伺服电机应该选择限制旋转180°的sg90，而不能选择mg90一类的360舵机，原因是后者只能调正反转和速度，而不能像前者一样旋转固定的角度。</strong><br><strong>3. Arduino程序烧录时，有三个必要的支持库需要下载，下面是下载链接以及安装方式。</strong>  </p><blockquote><p>AFMotor Library <a href="https://learn.adafruit.com/adafruit-motor-shield/library-install">https://learn.adafruit.com/adafruit-motor-shield/library-install</a><br>NewPing Library <a href="https://github.com/livetronic/Arduino-NewPing">https://github.com/livetronic/Arduino-NewPing</a><br>Servo Library <a href="https://github.com/arduino-libraries/Servo.git">https://github.com/arduino-libraries/Servo.git</a> </p></blockquote><p><strong>点击 sketch（项目） &gt;&gt; Include Library（加载库） &gt;&gt; Add .ZIP File（添加zip.文件），把你下载好的库文件添加进去。</strong></p><h2 id="五、成品展示"><a href="#五、成品展示" class="headerlink" title="五、成品展示"></a>五、成品展示</h2><p><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gycjki1pbaj33401qohdu.jpg" alt="智能车.jpg"></p>]]></content>
    
    
    <summary type="html">这是一个小巧简单的避障车的设计，也算是Arduino中比较火的项目了，试着学习了一下，通过项目来更深入的理解和应用Arduino</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="嵌入式" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="嵌入式开发" scheme="http://yoursite.com/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="Arduino" scheme="http://yoursite.com/tags/Arduino/"/>
    
  </entry>
  
  <entry>
    <title>【学习记录】关于原博客向新电脑迁移的步骤</title>
    <link href="http://yoursite.com/2022/01/13/Migration_Blog/"/>
    <id>http://yoursite.com/2022/01/13/Migration_Blog/</id>
    <published>2022-01-13T13:37:04.000Z</published>
    <updated>2023-11-01T17:44:42.027Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>首先，新电脑肯定是需要安装好<code>nodejs</code>和<code>git</code>的,这是大的前提。</p><h2 id="文件的备份"><a href="#文件的备份" class="headerlink" title="文件的备份"></a>文件的备份</h2><p>文件的备份是个问题，究竟哪些文件是必要的哪些是可以舍弃掉的，一开始我的想法是只要带走博客的md文件就好了，大不了重新发布，然后就意识到这是新做一个网站了，那么把<code>_config.yml</code>文件带走呢？似乎也不够，我们还需要吧<code>themes</code>文件也拷贝过去。那么干脆将整个Blog根目录全部拷贝，但是这样会不会产生冲突？最后参考<a href="https://www.cnblogs.com/iHeling/p/14095937.html">如何迁移hexo博客到新电脑</a>这篇博客，确定了最终的文件。  </p><ul><li>_config.yml</li><li>themes</li><li>source</li><li>scaffolds</li><li>package.json</li><li>gitignore<br>这些文件都有其作用，文章作者如此描述：  <blockquote><p>从之前的博客文件夹中选择必须要拷贝的文件，备份起来。首先是之前自己修改的文件，像配置文件<code>_config.yml</code>,<code>theme</code>文件夹，<code>source</code>文件夹自己写的原始文件这些都是必须要拷贝走的。除此之外还有<code>scaffolds</code>文件夹(文件的模板)，<code>package.json</code>(使用哪些包)，<code>.gitignore</code>(提交忽略哪些文件夹)  </p></blockquote></li></ul><h2 id="正式迁移"><a href="#正式迁移" class="headerlink" title="正式迁移"></a>正式迁移</h2><p>以上准备好之后便开始迁移了，全局安装<code>hexo</code>是很有必要的。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure><p>然后我们新建一个博客文件夹<br>创建完成之后将我们备份来的文件放进文件夹内，<strong>之后不需要执行<code>hexo init</code>，直接<code>hexo clean&amp;hexo g&amp;hexo s</code>即可。</strong><br>接下来的步骤就与一开始搭建网站时一样了，为了push到github上去，我们需要获取ssh：<br>1.在博客文件夹中打开git bash，然后敲上  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;yourname&quot;</span><br><span class="line">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure><p>2.创建SSH,密码、路径之类的不用管，一直回车就好</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br></pre></td></tr></table></figure><p>3.这个时候它会告诉你已经生成了<code>.ssh</code>的文件夹。在你的电脑中找到这个文件夹。<br>ssh，简单来讲，就是一个秘钥，其中，<code>id_rsa</code>是私人秘钥，<code>id_rsa.pub</code>是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上。<br>而后在GitHub的setting中，<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/%25D%40T6A(JI0U7SE826R9)ZJB.png" alt="1.png"><br>找到SSH and GPC keys的设置选项，<br><img src="https://raw.githubusercontent.com/isNineSun/img_repository/main/1.png" alt="2.png"><br>点击New SSH key<br>把你的id_rsa.pub里面的信息复制进去,title随便填写。  </p><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>直接发布自己的网站，就完成了个人博客的迁移。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">没想到刚开始更新Blog没几天就遇到了需要向新电脑迁移的事情，索性记录下来，由于没怎么接触过前端，个人网站搭建的过程始终让我感到新奇，每天感觉都是在接触新的知识。一开始想要迁移的时候还挺迷茫的，感觉这个过程肯定会有很多坑，没想到最后以外的简单顺利。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="随笔/杂项" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E9%9A%8F%E7%AC%94-%E6%9D%82%E9%A1%B9/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="记录" scheme="http://yoursite.com/tags/%E8%AE%B0%E5%BD%95/"/>
    
    <category term="Hexo" scheme="http://yoursite.com/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>基于stc89c51Rc的扫码取件设计</title>
    <link href="http://yoursite.com/2022/01/12/ExpressageInfo/"/>
    <id>http://yoursite.com/2022/01/12/ExpressageInfo/</id>
    <published>2022-01-12T09:58:04.000Z</published>
    <updated>2023-11-01T17:35:35.691Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、项目介绍"><a href="#一、项目介绍" class="headerlink" title="一、项目介绍"></a>一、项目介绍</h2><h3 id="1-课题意义"><a href="#1-课题意义" class="headerlink" title="1.课题意义"></a>1.课题意义</h3><p>当今时代，国内信息化步伐逐渐加快，随着互联网和电子商务的迅速发展和普及，网络购物已成为人们生活中不可缺少的一部分。现在快递服务业已发展到一定规模，但是快递服务效率却停滞不前。一个好的物流公司想要在这个社会站稳脚跟，需要的不仅仅是传输速度，更重要的是用合理的方法来加快精简各个步骤所需要花费的时间和精力，而快递网点系统是物流这个大模块中一个重要的子系统。单纯的人工取货费时费力，本设计以取件码为依据来实现快递的货物识别，取快递时出示取件码，扫码之后，对应的货物自动发声或发光提示其所在位置，据此想法，从而设计本系统。</p><h3 id="2-实现要求"><a href="#2-实现要求" class="headerlink" title="2.实现要求"></a>2.实现要求</h3><p>本课题是设计一个基于单片机的快递网点货物识别系统，以扫码模块、基于单片机的货物识别等关键技术为重点研究对象设计系统，研究设计的目标是在快递网点取货时更加方便，让客户在取货时出示取件码，扫码之后，对应的货物自动发声或者发光提示其所在位置，便于客户快速取件成功。同时需要了解系统原理、原理、特点、控制方式、应用情况、工作流程等，实现系统货物识别、声光控制等基本功能要求。</p><hr><h2 id="二、原件清单"><a href="#二、原件清单" class="headerlink" title="二、原件清单"></a>二、原件清单</h2><ul><li>Stc89c52Rc*1  </li><li>单片机最小系统*1  </li><li>QX1100扫码器*1  </li><li>有源蜂鸣器*3  </li><li>LED发光二极管*3  </li><li>1k电阻*12  </li><li>330Ω电阻*3  </li><li>npn三极管*3  </li><li>杜邦线 若干  </li><li>排针 若干  </li></ul><hr><h2 id="三、原理框图"><a href="#三、原理框图" class="headerlink" title="三、原理框图"></a>三、原理框图</h2><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyarp1xvj5j30820cpt90.jpg" alt="快递信息二维码生成软件流程图" title="软件"><br>软件  </p><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyarp1y4eoj30hq0duaau.jpg" alt="快递信息二维码读取硬件流程图" title="硬件"><br>硬件  </p><h2 id="三、电路连接"><a href="#三、电路连接" class="headerlink" title="三、电路连接"></a>三、电路连接</h2><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyatt2ebp4j30ns0mhtls.jpg" alt="protues仿真连接（仅供参考）"><br>图中1、2、3为三个子端设备，即贴在快递上用来声光报警的设备。仿真图仅供连接参考，我本身是在草稿纸上画的线路因此这个仿真只体现大体思路。  </p><p><strong>注意：实际连接时P2口需接1k的上拉电阻来稳压，发光二极管串联330欧姆电阻，三极管基极接1k电阻。</strong> </p><hr><h2 id="四、实物展示"><a href="#四、实物展示" class="headerlink" title="四、实物展示"></a>四、实物展示</h2><h3 id="1-软件展示"><a href="#1-软件展示" class="headerlink" title="1.软件展示"></a>1.软件展示</h3><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyau3ktfyhj30ag0g30tq.jpg" alt="软件界面">  </p><ul><li>在最上方生成二维码。</li><li>中间填入快递货架号，格式为xxx（<em>排、行、个，如：123，代表第一排第二行第三个</em>）。</li><li>点击录入会自动生成二维码并记录进快递列表。</li><li>点击快递列表即可查看存入快递。</li><li>点击“关闭”关闭应用。</li><li>在qq邮箱栏，输入qq邮箱点击发送会将二维码以邮件附件的形式发送给用户。</li><li>最下方是信息提示栏。  </li></ul><h3 id="2-硬件展示"><a href="#2-硬件展示" class="headerlink" title="2.硬件展示"></a>2.硬件展示</h3><p><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gyautmd500j30j60ya0vd.jpg" alt="背面"><br>背面（三个子端）<br><img src="http://tva1.sinaimg.cn/mw690/008ruEzYly1gyauu3cxrhj30tu1hcads.jpg" alt="正面"><br>正面（扫码器）</p><hr><h2 id="五、程序代码"><a href="#五、程序代码" class="headerlink" title="五、程序代码"></a>五、程序代码</h2><h3 id="1-软件程序"><a href="#1-软件程序" class="headerlink" title="1.软件程序"></a>1.软件程序</h3><p>软件是基于unity进行开发的，之所以不选用VS开发是因为对我个人来说unity的ui设计更加直观明了。两者都是用的C#语言，因此在代码方面实际上差别并不很大。以下贴一下关键代码：<br><strong>(1)QQ邮件发送代码</strong>  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br><span class="line">using System.Collections;</span><br><span class="line">using System;</span><br><span class="line">using System.Net;</span><br><span class="line">using System.Net.Mail;</span><br><span class="line">using System.Net.Security;</span><br><span class="line">using System.Security.Cryptography.X509Certificates;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line">public class Mail : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public GameObject Text_02,send;</span><br><span class="line">    public Vector2 creatPosition;</span><br><span class="line"></span><br><span class="line">    public void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (GameObject.Find(&quot;QQMileAdress&quot;).GetComponent&lt;Text&gt;().text.Length &lt;= 14)</span><br><span class="line">        &#123;</span><br><span class="line">            send.GetComponent&lt;Button&gt;().interactable = false;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            send.GetComponent&lt;Button&gt;().interactable = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void SendEmail()</span><br><span class="line">    &#123;</span><br><span class="line">        MailMessage mail = new MailMessage();</span><br><span class="line"></span><br><span class="line">        mail.From = new MailAddress(&quot;xxx@qq.com&quot;);//发件人</span><br><span class="line">        mail.To.Add(GameObject.Find(&quot;QQMileAdress&quot;).GetComponent&lt;Text&gt;().text);//收件人</span><br><span class="line">        mail.Subject = &quot;Test Mail&quot;;//标题</span><br><span class="line">        mail.Body = &quot;This is for Me&quot;;//内容</span><br><span class="line">        mail.Attachments.Add(new Attachment(Application.dataPath + &quot;/&quot; + &quot;QR.png&quot;));//附件</span><br><span class="line"></span><br><span class="line">        SmtpClient smtpServer = new SmtpClient(&quot;smtp.qq.com&quot;);</span><br><span class="line">        smtpServer.Credentials = new System.Net.NetworkCredential(&quot;xxx@qq.com&quot;, &quot;xxxxxxxxxxxxxx&quot;) as ICredentialsByHost;</span><br><span class="line">        //Credentials证书    NetworkCredential网络证书     xxxxxxxxxxxxxx邮箱授权密码！</span><br><span class="line">        smtpServer.EnableSsl = true;</span><br><span class="line">        ServicePointManager.ServerCertificateValidationCallback =</span><br><span class="line">          delegate (object s, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)</span><br><span class="line">          &#123; return true; &#125;;</span><br><span class="line"></span><br><span class="line">        smtpServer.Send(mail);</span><br><span class="line">        Instantiate(Text_02, creatPosition, Quaternion.identity, GameObject.Find(&quot;Canvas&quot;).transform);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><strong>(2)QR码生成</strong>  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line">using ZXing;</span><br><span class="line">using ZXing.QrCode;</span><br><span class="line">using System.IO;</span><br><span class="line"></span><br><span class="line">public class QR_Code : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public string QrCodeStr;</span><br><span class="line">    public List&lt;string&gt; Mylist;</span><br><span class="line">    public GameObject Text, createPosition;</span><br><span class="line">    //在屏幕上显示二维码</span><br><span class="line">    public RawImage image;</span><br><span class="line">    public Text Items;</span><br><span class="line">    //存放二维码</span><br><span class="line">    Texture2D encoded;</span><br><span class="line">    int Nmuber = 0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        encoded = new Texture2D(256, 256);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.Return))</span><br><span class="line">        &#123;</span><br><span class="line">            Sign();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    /// 定义方法生成二维码</span><br><span class="line">    private static Color32[] Encode(string textForEncoding, int width, int height)</span><br><span class="line">    &#123;</span><br><span class="line">        var writer = new BarcodeWriter</span><br><span class="line">        &#123;</span><br><span class="line">            Format = BarcodeFormat.QR_CODE,</span><br><span class="line">            Options = new QrCodeEncodingOptions</span><br><span class="line">            &#123;</span><br><span class="line">                Height = height,</span><br><span class="line">                Width = width</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        return writer.Write(textForEncoding);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /// 生成二维码</span><br><span class="line">    public void Btn_CreatQr()</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if (QrCodeStr==null || GameObject.Find(&quot;number&quot;).GetComponent&lt;Text&gt;().text.Length&gt;0)</span><br><span class="line">        &#123;</span><br><span class="line">            QrCodeStr = GameObject.Find(&quot;number&quot;).GetComponent&lt;Text&gt;().text;</span><br><span class="line">            Mylist.Add(QrCodeStr+&quot;\n&quot;);</span><br><span class="line">            //二维码写入图片</span><br><span class="line">            var color32 = Encode(QrCodeStr, encoded.width, encoded.height);</span><br><span class="line">            encoded.SetPixels32(color32);</span><br><span class="line">            encoded.Apply();</span><br><span class="line">            //生成的二维码图片附给RawImage</span><br><span class="line">            image.texture = encoded;</span><br><span class="line">        &#125;</span><br><span class="line">        else </span><br><span class="line">        &#123;</span><br><span class="line">            Instantiate(Text, createPosition.transform.position, Quaternion.identity,transform);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void Sign()</span><br><span class="line">    &#123;</span><br><span class="line">        Btn_CreatQr();</span><br><span class="line">        SaveTextureToFile();</span><br><span class="line">        Nmuber++;</span><br><span class="line">        if (Nmuber &gt;= QrCodeStr.Length)</span><br><span class="line">        &#123;</span><br><span class="line">            Nmuber = 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public void list()</span><br><span class="line">    &#123;</span><br><span class="line">        Items.text = null;</span><br><span class="line">        foreach (var item in Mylist)</span><br><span class="line">        &#123;</span><br><span class="line">            Items.text += item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public void Quit()</span><br><span class="line">    &#123;</span><br><span class="line">        Application.Quit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void SaveTextureToFile()</span><br><span class="line">    &#123;</span><br><span class="line">        var bytes = encoded.EncodeToPNG();</span><br><span class="line">        File.WriteAllBytes(Application.dataPath + &quot;/&quot; + &quot;QR.png&quot;, bytes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>(3)52单片机程序</strong>  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;reg52.h&quot;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">typedef unsigned int u16;//对系统默认数据类型进行重定义</span><br><span class="line">typedef unsigned char u8;</span><br><span class="line">typedef unsigned long u32;</span><br><span class="line"></span><br><span class="line">void delay_10us(u16 ten_us);</span><br><span class="line">void delay_ms(u16 ms);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">unsigned char num[][10]=&#123;&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;&#125;;</span><br><span class="line">u8 led[9]=&#123;0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80&#125;;</span><br><span class="line">u8 n;</span><br><span class="line">//****************************************************************************************</span><br><span class="line"></span><br><span class="line">void delay_10us(u16 ten_us)</span><br><span class="line">&#123;</span><br><span class="line">while(ten_us--);</span><br><span class="line">&#125;</span><br><span class="line">void delay_ms(u16 ms)</span><br><span class="line">&#123;</span><br><span class="line">u16 i,j;</span><br><span class="line">for(i=ms;i&gt;0;i--)</span><br><span class="line">for(j=110;j&gt;0;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//****************************************************************************************</span><br><span class="line">void uart_init(u8 baud)</span><br><span class="line">&#123;</span><br><span class="line">TMOD|=0X20;//设置计数器工作方式2</span><br><span class="line">SCON=0X50;//设置为工作方式1</span><br><span class="line">PCON=0X80;//波特率加倍</span><br><span class="line">TH1=baud;//计数器初始值设置</span><br><span class="line">TL1=baud;</span><br><span class="line">ES=1;//打开接收中断</span><br><span class="line">EA=1;//打开总中断</span><br><span class="line">TR1=1;//打开计数器</span><br><span class="line">&#125;</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">int r;</span><br><span class="line">uart_init(0XFA);//波特率为9600</span><br><span class="line"></span><br><span class="line">while(1)</span><br><span class="line">&#123;</span><br><span class="line">if(n &gt;= &#x27;0&#x27; &amp;&amp; n &lt;= &#x27;9&#x27;)</span><br><span class="line">r=n-&#x27;0&#x27;;</span><br><span class="line">  P2=led[r];</span><br><span class="line">//lcd1602_init();//LCD1602初始化</span><br><span class="line">  //lcd1602_show_string(0,0,num[r]);//第一行显示</span><br><span class="line">delay_ms(10);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void uart() interrupt 4 //串口通信中断函数</span><br><span class="line">&#123;</span><br><span class="line">u8 rec_data;</span><br><span class="line"></span><br><span class="line">RI = 0;//清除接收中断标志位</span><br><span class="line">rec_data=SBUF;//存储接收到的数据</span><br><span class="line">n=rec_data;</span><br><span class="line">SBUF=rec_data;//将接收到的数据放入到发送寄存器</span><br><span class="line">while(!TI);//等待发送数据完成</span><br><span class="line">TI=0;//清除发送完成标志位</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>有一些用来控制ui动画的小代码就不放出来了，大家根据自己的需要去修改就好。 </p><hr><h2 id="六、设备运行结果"><a href="#六、设备运行结果" class="headerlink" title="六、设备运行结果"></a>六、设备运行结果</h2><p>视频我已上传百度云，需要看设备运行的可以下载来看<br>链接：<a href="https://pan.baidu.com/s/1Evjrf5T2KU6Vl3sgDGIIZQ">百度云</a><br>提取码：k2w6 </p>]]></content>
    
    
    <summary type="html">一种通过取件码快速获得快递位置的设计。</summary>
    
    
    
    <category term="设计开发" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/"/>
    
    <category term="嵌入式" scheme="http://yoursite.com/categories/%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="嵌入式开发" scheme="http://yoursite.com/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="STC51" scheme="http://yoursite.com/tags/STC51/"/>
    
  </entry>
  
  <entry>
    <title>【学习记录】MarkDown语法的学习与整理</title>
    <link href="http://yoursite.com/2022/01/12/MaikdownEdit/"/>
    <id>http://yoursite.com/2022/01/12/MaikdownEdit/</id>
    <published>2022-01-12T06:36:04.000Z</published>
    <updated>2023-11-01T17:56:20.222Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、Markdown标题"><a href="#一、Markdown标题" class="headerlink" title="一、Markdown标题"></a>一、Markdown标题</h2><p>Markdown的标题可以使用“#”+空格来进行分级，几级标题就写几个“#”，最多可至六级标题。<br>例子：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 一级标题</span><br><span class="line">## 二级标题</span><br><span class="line">### 三级标题</span><br><span class="line">#### 四级标题</span><br><span class="line">##### 五级标题</span><br><span class="line">###### 六级标题</span><br></pre></td></tr></table></figure><p>效果👇</p><h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6><hr><h2 id="二、Markdown段落"><a href="#二、Markdown段落" class="headerlink" title="二、Markdown段落"></a>二、Markdown段落</h2><p>1.使用两个空格来换行<br>例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你好，世界！//无换行</span><br><span class="line">你好，  世界！//换行</span><br></pre></td></tr></table></figure><p>效果👇<br>你好，世界！//无换行</p><p>你好，<br>世界！//换行</p><p>2.使用三个以上“-”来画分割线<br>例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---</span><br></pre></td></tr></table></figure><p>效果👇  </p><hr><p>3.使用“*”来赋予不同的字体<br>例子：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*斜体文本*</span><br><span class="line">**粗体文本**</span><br><span class="line">***粗斜体文本***</span><br></pre></td></tr></table></figure><p>效果👇<br><em>斜体文本</em><br><strong>粗体文本</strong><br><em><strong>粗斜体文本</strong></em>  </p><hr><h2 id="三、Markdown代码"><a href="#三、Markdown代码" class="headerlink" title="三、Markdown代码"></a>三、Markdown代码</h2><p>用“```”包裹一段代码，并指定一种语言（也可以不指定）<br>例子：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">``` </span><br><span class="line">printf();</span><br><span class="line">```</span><br></pre></td></tr></table></figure><p>效果👇  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf();</span><br></pre></td></tr></table></figure><hr><h2 id="四、Markdown的链接形式"><a href="#四、Markdown的链接形式" class="headerlink" title="四、Markdown的链接形式"></a>四、Markdown的链接形式</h2><p>用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[链接名称](www.xxxxxx.com)</span><br></pre></td></tr></table></figure><p>的形式来生成一个不直接暴露网址的链接。<br>例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[isNineSun&#x27;s Blog](www.isNineSun.github.io)</span><br></pre></td></tr></table></figure><p>效果👇<br><a href="www.isNineSun.github.io">isNineSun’s Blog</a><br><strong>如果你要直接引用网址而不用包装那么直接打进正文即可</strong></p><hr><h2 id="五、Markdown图片"><a href="#五、Markdown图片" class="headerlink" title="五、Markdown图片"></a>五、Markdown图片</h2><ul><li>开头一个感叹号!</li><li>然后是中括号[]，中间写上你的图片描述，<em>在点开图片的时候会显示</em>。</li><li>后面加上你的图片地址，也可以再多添加一个图片的“描述”。<br>例子：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![_嘉然.jpg](http://tva1.sinaimg.cn/large/008ruEzYly1gyawosia27j30hs0hsmy2.jpg)</span><br><span class="line"></span><br><span class="line">![_嘉然.jpg](http://tva1.sinaimg.cn/large/008ruEzYly1gyawosia27j30hs0hsmy2.jpg &quot;嘉然&quot;)</span><br></pre></td></tr></table></figure>效果👇<br><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyawosia27j30hs0hsmy2.jpg" alt="_嘉然.jpg"></li></ul><p><img src="http://tva1.sinaimg.cn/large/008ruEzYly1gyawosia27j30hs0hsmy2.jpg" alt="_嘉然.jpg" title="嘉然">  </p><hr><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>这是我日常中可能常用的几个语法的整理，如果你需要更全面的教程，欢迎去访问<a href="https://www.runoob.com/markdown/md-tutorial.html">菜鸟的Markdown教程</a>。</p>]]></content>
    
    
    <summary type="html">接触了一小段时间的Markdown文件的编写了，深感他能被众人所推崇的确有其独特之处，因此开一篇博客记录下markdown常用的一些有语法，既是一种整理也是一个加深印象和巩固的过程。感谢菜鸟教程的详细总结，省去了我不少时间，这里只介绍我常用到的，如果需要请点击链接来更全面的学习https://www.runoob.com/markdown/md-tutorial.html。</summary>
    
    
    
    <category term="学习记录" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    <category term="语法相关" scheme="http://yoursite.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E8%AF%AD%E6%B3%95%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="学习" scheme="http://yoursite.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="记录" scheme="http://yoursite.com/tags/%E8%AE%B0%E5%BD%95/"/>
    
    <category term="Markdown" scheme="http://yoursite.com/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>我的第一篇博客</title>
    <link href="http://yoursite.com/2022/01/11/MyFirstBlog/"/>
    <id>http://yoursite.com/2022/01/11/MyFirstBlog/</id>
    <published>2022-01-11T09:58:04.000Z</published>
    <updated>2023-11-01T17:50:22.745Z</updated>
    
    <content type="html"><![CDATA[<h2 id="嗨！"><a href="#嗨！" class="headerlink" title="嗨！"></a>嗨！</h2><p>幸会，这是我的第一篇博客，希望不会是最后一篇233，如果你对我感兴趣，可以看一看我下面的自述。</p><hr><h2 id="这个个人博客的目的"><a href="#这个个人博客的目的" class="headerlink" title="这个个人博客的目的"></a>这个个人博客的目的</h2><p>这个技术博客主要是为了能够更好的记录我在学习中会遇到的种种事情，可能是难题，可能是踩坑，可能是灵感，可能是新的技术，我的涉猎比较广，游戏、单片机、编程、绘画等等我都有兴趣，随着学的东西越来越多，我萌生出将自己所学记录下来的想法，一个个人博客想来是再好不过的方式了，我会尽量在知乎等大的平台上同步更新。<br>我在学习中也不止一次的被他人的技术博客所拯救，一个百思不得其解的问题可能在他人的技术博客中用一两句话就说明白了，颇有“听君一席话胜读十年书”的感觉，我希望我的技术博客也能够帮到每一个人！</p><hr><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>以上，就结束了我简短的第一篇博客，希望在今后的日子里我能够先将自己的博客充实起来。<br><img src="https://s2.loli.net/2022/01/12/rGQZiH2Fal51BVq.png" alt="This is me" title="This is not me"></p>]]></content>
    
    
    <summary type="html">幸会，这是我的第一篇博客，希望不会是最后一篇233，如果你对我感兴趣，可以看一看我下面的自述。</summary>
    
    
    
    <category term="生活记录" scheme="http://yoursite.com/categories/%E7%94%9F%E6%B4%BB%E8%AE%B0%E5%BD%95/"/>
    
    <category term="碎碎念" scheme="http://yoursite.com/categories/%E7%94%9F%E6%B4%BB%E8%AE%B0%E5%BD%95/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
    
    
    <category term="随笔" scheme="http://yoursite.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="HelloWorld" scheme="http://yoursite.com/tags/HelloWorld/"/>
    
  </entry>
  
</feed>
